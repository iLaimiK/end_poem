import{createPinia as e,defineStore as r,storeToRefs as a}from'https://testingcf.jsdelivr.net/npm/pinia/+esm';var t={42:(e,r)=>{r.A=(e,r)=>{const a=e.__vccOpts||e;for(const[e,t]of r)a[e]=t;return a}},53:(e,r,a)=>{var t=a(953);t.__esModule&&(t=t.default),'string'==typeof t&&(t=[[e.id,t,'']]),t.locals&&(e.exports=t.locals);(0,a(424).A)('f539a72e',t,!1,{ssrId:!0})},54:e=>{e.exports=function(e){var r=[];return r.toString=function(){return this.map(function(r){var a='',t=void 0!==r[5];return r[4]&&(a+='@supports ('.concat(r[4],') {')),r[2]&&(a+='@media '.concat(r[2],' {')),t&&(a+='@layer'.concat(r[5].length>0?' '.concat(r[5]):'',' {')),a+=e(r),t&&(a+='}'),r[2]&&(a+='}'),r[4]&&(a+='}'),a}).join('')},r.i=function(e,a,t,n,i){'string'==typeof e&&(e=[[null,e,void 0]]);var A={};if(t)for(var o=0;o<this.length;o++){var l=this[o][0];null!=l&&(A[l]=!0)}for(var s=0;s<e.length;s++){var p=[].concat(e[s]);t&&A[p[0]]||(void 0!==i&&(void 0===p[5]||(p[1]='@layer'.concat(p[5].length>0?' '.concat(p[5]):'',' {').concat(p[1],'}')),p[5]=i),a&&(p[2]?(p[1]='@media '.concat(p[2],' {').concat(p[1],'}'),p[2]=a):p[2]=a),n&&(p[4]?(p[1]='@supports ('.concat(p[4],') {').concat(p[1],'}'),p[4]=n):p[4]=''.concat(n)),r.push(p))}},r}},123:(e,r,a)=>{a.r(r),a.d(r,{default:()=>o});var t=a(790),n=a.n(t),i=a(54),A=a.n(i)()(n());A.push([e.id,'.aplayer[data-v-1409529e]{position:absolute;left:0;bottom:0;z-index:9999;background:#fff;border-radius:0;box-shadow:0 2px 2px 0 rgba(0,0,0,.14),0 3px 1px -2px rgba(0,0,0,.2),0 1px 5px 0 rgba(0,0,0,.12);font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;font-size:12px;line-height:normal;max-width:400px;min-width:300px;transition:all .3s ease}.aplayer.aplayer-narrow[data-v-1409529e]{width:18px;min-width:18px;transform:translateX(-20%)}.aplayer.aplayer-narrow .aplayer-info[data-v-1409529e]{display:none}.aplayer.aplayer-narrow .aplayer-miniswitcher .aplayer-icon[data-v-1409529e]{transform:rotate(0)}.aplayer-body[data-v-1409529e]{display:flex;position:relative;overflow:hidden;height:66px;padding-right:18px}.aplayer-pic[data-v-1409529e]{position:relative;width:66px;height:66px;background-size:cover;background-position:center;transition:all .3s ease;cursor:pointer;flex-shrink:0;overflow:hidden}.aplayer-pic .aplayer-pic-img[data-v-1409529e]{width:100%;height:100%;object-fit:cover;display:block}.aplayer-pic .aplayer-button[data-v-1409529e]{position:absolute;display:flex;align-items:center;justify-content:center;outline:none;cursor:pointer;color:#fff;border-radius:50%;border:2px solid hsla(0,0%,100%,.8);top:50%;left:50%;transform:translate(-50%,-50%);width:30px;height:30px;background:rgba(0,0,0,.2);font-size:16px;transition:all .1s ease-out}.aplayer-pic .aplayer-button[data-v-1409529e]:hover{border-color:#fff}.aplayer-pic .aplayer-button.aplayer-button-playing[data-v-1409529e]{top:auto;left:auto;bottom:6px;right:6px;transform:none;width:20px;height:20px;background:rgba(0,0,0,0);font-size:10px}.aplayer-pic .aplayer-button .fa-play[data-v-1409529e]{text-align:center;height:15px;width:8px;font-size:14px}.aplayer-pic .aplayer-button .fa-pause[data-v-1409529e]{text-align:center;height:10px;width:12px}.aplayer-info[data-v-1409529e]{flex:1;display:flex;flex-direction:column;min-width:0;padding:8px 15px 10px 15px;justify-content:space-between;border-top:1px solid #e9e9e9}.aplayer-info-top[data-v-1409529e]{display:flex;align-items:center;flex-wrap:nowrap}.aplayer-music[data-v-1409529e]{flex:1;overflow:hidden;margin-right:15px;min-width:0}.aplayer-music .aplayer-title[data-v-1409529e]{font-size:14px;font-weight:400;color:#212121;margin:0 0 2px 0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;line-height:1.1}.aplayer-music .aplayer-author[data-v-1409529e]{font-size:12px;color:#666;margin:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;line-height:1.1}.aplayer-controller[data-v-1409529e]{display:flex;align-items:center;width:100%}.aplayer-time[data-v-1409529e]{display:flex;align-items:center;color:#999;font-size:11px;flex-shrink:0;white-space:nowrap}.aplayer-time .aplayer-time-inner[data-v-1409529e]{margin-right:7px;font-variant-numeric:tabular-nums}.aplayer-time .aplayer-ptime[data-v-1409529e],.aplayer-time .aplayer-dtime[data-v-1409529e]{font-variant-numeric:tabular-nums}.aplayer-order[data-v-1409529e]{background:none;border:none;outline:none;cursor:pointer;color:#999;font-size:11px;padding:0;transition:all .2s ease;width:15px;height:15px;display:flex;align-items:center;justify-content:center;margin:0 1px}.aplayer-order[data-v-1409529e]:hover{color:#b7daff}.aplayer-miniswitcher[data-v-1409529e]{position:absolute;top:0;right:0;bottom:0;height:100%;background:#e6e6e6;width:18px;border-radius:0 2px 2px 0}.aplayer-miniswitcher .aplayer-icon[data-v-1409529e]{height:100%;width:100%;transform:rotate(180deg);transition:all .3s ease;border:none;background-color:rgba(0,0,0,0);outline:none;cursor:pointer;opacity:.8;vertical-align:middle;padding:0;font-size:12px;margin:0;display:inline-block}.aplayer-miniswitcher .aplayer-icon svg[data-v-1409529e]{width:12px;height:12px;fill:#666}@media screen and (max-width:1024px){.aplayer[data-v-1409529e]{max-width:calc(100vw - 40px)}}@media screen and (max-width:768px){.aplayer[data-v-1409529e]{bottom:80% !important;max-width:calc(100vw - 20px);min-width:auto}.aplayer.aplayer-narrow[data-v-1409529e]{bottom:80% !important}}@media screen and (max-width:640px){.aplayer-body[data-v-1409529e]{height:58px}.aplayer-pic[data-v-1409529e]{width:58px;height:58px}.aplayer-info[data-v-1409529e]{padding:7px 12px 9px 12px}}@media screen and (max-width:480px){.aplayer-body[data-v-1409529e]{height:54px}.aplayer-pic .aplayer-author[data-v-1409529e]{font-size:11px}.aplayer-time .aplayer-time-inner[data-v-1409529e]{margin-right:5px}.aplayer-order[data-v-1409529e]{width:13px;height:13px;font-size:10px}}@media screen and (max-width:390px){.aplayer-body[data-v-1409529e]{height:50px}.aplayer-pic[data-v-1409529e]{width:50px;height:50px}.aplayer-info[data-v-1409529e]{padding:4px 10px 6px 10px}.aplayer-music .aplayer-title[data-v-1409529e]{font-size:12px}.aplayer-music .aplayer-author[data-v-1409529e]{font-size:10px}}@media screen and (max-width:320px){.aplayer-body[data-v-1409529e]{height:46px}.aplayer-pic[data-v-1409529e]{width:46px;height:46px}.aplayer-info[data-v-1409529e]{padding:3px 8px 5px 8px}.aplayer-order[data-v-1409529e]{display:none}}','',{version:3,sources:['webpack://./src/Aplayer_imitation/components/MusicPlayer.vue'],names:[],mappings:'AACA,0BACE,iBAAA,CACA,MAAA,CACA,QAAA,CACA,YAAA,CACA,eAAA,CACA,eAAA,CACA,gGACE,CAGF,+EAAA,CACA,cAAA,CACA,kBAAA,CACA,eAAA,CACA,eAAA,CACA,uBAAA,CAEA,yCACE,UAAA,CACA,cAAA,CACA,0BAAA,CAEA,uDACE,YAAA,CAIA,6EACE,mBAAA,CAMR,+BACE,YAAA,CACA,iBAAA,CACA,eAAA,CACA,WAAA,CACA,kBAAA,CAGF,8BACE,iBAAA,CACA,UAAA,CACA,WAAA,CACA,qBAAA,CACA,0BAAA,CACA,uBAAA,CACA,cAAA,CACA,aAAA,CACA,eAAA,CAEA,+CACE,UAAA,CACA,WAAA,CACA,gBAAA,CACA,aAAA,CAGF,8CACE,iBAAA,CACA,YAAA,CACA,kBAAA,CACA,sBAAA,CACA,YAAA,CACA,cAAA,CACA,UAAA,CACA,iBAAA,CACA,mCAAA,CAEA,OAAA,CACA,QAAA,CACA,8BAAA,CACA,UAAA,CACA,WAAA,CACA,yBAAA,CACA,cAAA,CACA,2BAAA,CAEA,oDACE,iBAAA,CAGF,qEACE,QAAA,CACA,SAAA,CACA,UAAA,CACA,SAAA,CACA,cAAA,CACA,UAAA,CACA,WAAA,CACA,wBAAA,CACA,cAAA,CAGF,uDACE,iBAAA,CACA,WAAA,CACA,SAAA,CACA,cAAA,CAGF,wDACE,iBAAA,CACA,WAAA,CACA,UAAA,CAKN,+BACE,MAAA,CACA,YAAA,CACA,qBAAA,CACA,WAAA,CACA,0BAAA,CACA,6BAAA,CACA,4BAAA,CAGF,mCACE,YAAA,CACA,kBAAA,CACA,gBAAA,CAGF,gCACE,MAAA,CACA,eAAA,CACA,iBAAA,CACA,WAAA,CAEA,+CACE,cAAA,CACA,eAAA,CACA,aAAA,CACA,gBAAA,CACA,eAAA,CACA,sBAAA,CACA,kBAAA,CACA,eAAA,CAGF,gDACE,cAAA,CACA,UAAA,CACA,QAAA,CACA,eAAA,CACA,sBAAA,CACA,kBAAA,CACA,eAAA,CAIJ,qCACE,YAAA,CACA,kBAAA,CACA,UAAA,CAGF,+BACE,YAAA,CACA,kBAAA,CACA,UAAA,CACA,cAAA,CACA,aAAA,CACA,kBAAA,CAEA,mDACE,gBAAA,CACA,iCAAA,CAGF,4FAEE,iCAAA,CAIJ,gCACE,eAAA,CACA,WAAA,CACA,YAAA,CACA,cAAA,CACA,UAAA,CACA,cAAA,CACA,SAAA,CACA,uBAAA,CACA,UAAA,CACA,WAAA,CACA,YAAA,CACA,kBAAA,CACA,sBAAA,CACA,YAAA,CAEA,sCACE,aAAA,CAIJ,uCACE,iBAAA,CACA,KAAA,CACA,OAAA,CACA,QAAA,CACA,WAAA,CACA,kBAAA,CACA,UAAA,CACA,yBAAA,CAEA,qDACE,WAAA,CACA,UAAA,CACA,wBAAA,CACA,uBAAA,CACA,WAAA,CACA,8BAAA,CACA,YAAA,CACA,cAAA,CACA,UAAA,CACA,qBAAA,CACA,SAAA,CACA,cAAA,CACA,QAAA,CACA,oBAAA,CAEA,yDACE,UAAA,CACA,WAAA,CACA,SAAA,CAMN,qCACE,0BACE,4BAAA,CAAA,CAIJ,oCACE,0BACE,qBAAA,CACA,4BAAA,CACA,cAAA,CAEA,yCACE,qBAAA,CAAA,CAMN,oCACE,+BACE,WAAA,CAGF,8BACE,UAAA,CACA,WAAA,CAGF,+BACE,yBAAA,CAAA,CAKJ,oCACE,+BACE,WAAA,CAIA,8CACE,cAAA,CAKF,mDACE,gBAAA,CAIJ,gCACE,UAAA,CACA,WAAA,CACA,cAAA,CAAA,CAKJ,oCACE,+BACE,WAAA,CAGF,8BACE,UAAA,CACA,WAAA,CAGF,+BACE,yBAAA,CAIA,+CACE,cAAA,CAGF,gDACE,cAAA,CAAA,CAMN,oCACE,+BACE,WAAA,CAGF,8BACE,UAAA,CACA,WAAA,CAGF,+BACE,uBAAA,CAGF,gCACE,YAAA,CAAA',sourcesContent:['\r\n.aplayer {\r\n  position: absolute;\r\n  left: 0;\r\n  bottom: 0;\r\n  z-index: 9999;\r\n  background: #fff;\r\n  border-radius: 0;\r\n  box-shadow:\r\n    0 2px 2px 0 rgba(0, 0, 0, 0.14),\r\n    0 3px 1px -2px rgba(0, 0, 0, 0.2),\r\n    0 1px 5px 0 rgba(0, 0, 0, 0.12);\r\n  font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Roboto, Arial, sans-serif;\r\n  font-size: 12px;\r\n  line-height: normal;\r\n  max-width: 400px;\r\n  min-width: 300px;\r\n  transition: all 0.3s ease;\r\n\r\n  &.aplayer-narrow {\r\n    width: 18px;\r\n    min-width: 18px;\r\n    transform: translateX(-20%);\r\n\r\n    .aplayer-info {\r\n      display: none;\r\n    }\r\n\r\n    .aplayer-miniswitcher {\r\n      .aplayer-icon {\r\n        transform: rotate(0);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.aplayer-body {\r\n  display: flex;\r\n  position: relative;\r\n  overflow: hidden;\r\n  height: 66px;\r\n  padding-right: 18px;\r\n}\r\n\r\n.aplayer-pic {\r\n  position: relative;\r\n  width: 66px;\r\n  height: 66px;\r\n  background-size: cover;\r\n  background-position: center;\r\n  transition: all 0.3s ease;\r\n  cursor: pointer;\r\n  flex-shrink: 0;\r\n  overflow: hidden;\r\n\r\n  .aplayer-pic-img {\r\n    width: 100%;\r\n    height: 100%;\r\n    object-fit: cover;\r\n    display: block;\r\n  }\r\n\r\n  .aplayer-button {\r\n    position: absolute;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    outline: none;\r\n    cursor: pointer;\r\n    color: #fff;\r\n    border-radius: 50%;\r\n    border: 2px solid rgba(255, 255, 255, 0.8);\r\n\r\n    top: 50%;\r\n    left: 50%;\r\n    transform: translate(-50%, -50%);\r\n    width: 30px;\r\n    height: 30px;\r\n    background: rgba(0, 0, 0, 0.2);\r\n    font-size: 16px;\r\n    transition: all 0.1s ease-out;\r\n\r\n    &:hover {\r\n      border-color: rgba(255, 255, 255, 1);\r\n    }\r\n\r\n    &.aplayer-button-playing {\r\n      top: auto;\r\n      left: auto;\r\n      bottom: 6px;\r\n      right: 6px;\r\n      transform: none;\r\n      width: 20px;\r\n      height: 20px;\r\n      background: transparent;\r\n      font-size: 10px;\r\n    }\r\n\r\n    .fa-play {\r\n      text-align: center;\r\n      height: 15px;\r\n      width: 8px;\r\n      font-size: 14px;\r\n    }\r\n\r\n    .fa-pause {\r\n      text-align: center;\r\n      height: 10px;\r\n      width: 12px;\r\n    }\r\n  }\r\n}\r\n\r\n.aplayer-info {\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n  min-width: 0;\r\n  padding: 8px 15px 10px 15px;\r\n  justify-content: space-between;\r\n  border-top: 1px solid #e9e9e9;\r\n}\r\n\r\n.aplayer-info-top {\r\n  display: flex;\r\n  align-items: center;\r\n  flex-wrap: nowrap;\r\n}\r\n\r\n.aplayer-music {\r\n  flex: 1;\r\n  overflow: hidden;\r\n  margin-right: 15px;\r\n  min-width: 0;\r\n\r\n  .aplayer-title {\r\n    font-size: 14px;\r\n    font-weight: 400;\r\n    color: #212121;\r\n    margin: 0 0 2px 0;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n    white-space: nowrap;\r\n    line-height: 1.1;\r\n  }\r\n\r\n  .aplayer-author {\r\n    font-size: 12px;\r\n    color: #666;\r\n    margin: 0;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n    white-space: nowrap;\r\n    line-height: 1.1;\r\n  }\r\n}\r\n\r\n.aplayer-controller {\r\n  display: flex;\r\n  align-items: center;\r\n  width: 100%;\r\n}\r\n\r\n.aplayer-time {\r\n  display: flex;\r\n  align-items: center;\r\n  color: #999;\r\n  font-size: 11px;\r\n  flex-shrink: 0;\r\n  white-space: nowrap;\r\n\r\n  .aplayer-time-inner {\r\n    margin-right: 7px;\r\n    font-variant-numeric: tabular-nums;\r\n  }\r\n\r\n  .aplayer-ptime,\r\n  .aplayer-dtime {\r\n    font-variant-numeric: tabular-nums;\r\n  }\r\n}\r\n\r\n.aplayer-order {\r\n  background: none;\r\n  border: none;\r\n  outline: none;\r\n  cursor: pointer;\r\n  color: #999;\r\n  font-size: 11px;\r\n  padding: 0;\r\n  transition: all 0.2s ease;\r\n  width: 15px;\r\n  height: 15px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  margin: 0 1px;\r\n\r\n  &:hover {\r\n    color: #b7daff;\r\n  }\r\n}\r\n\r\n.aplayer-miniswitcher {\r\n  position: absolute;\r\n  top: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  height: 100%;\r\n  background: #e6e6e6;\r\n  width: 18px;\r\n  border-radius: 0 2px 2px 0;\r\n\r\n  .aplayer-icon {\r\n    height: 100%;\r\n    width: 100%;\r\n    transform: rotate(180deg);\r\n    transition: all 0.3s ease;\r\n    border: none;\r\n    background-color: transparent;\r\n    outline: none;\r\n    cursor: pointer;\r\n    opacity: 0.8;\r\n    vertical-align: middle;\r\n    padding: 0;\r\n    font-size: 12px;\r\n    margin: 0;\r\n    display: inline-block;\r\n\r\n    svg {\r\n      width: 12px;\r\n      height: 12px;\r\n      fill: #666;\r\n    }\r\n  }\r\n}\r\n\r\n// 移动端适配 - 标准响应式断点\r\n@media screen and (max-width: 1024px) {\r\n  .aplayer {\r\n    max-width: calc(100vw - 40px);\r\n  }\r\n}\r\n\r\n@media screen and (max-width: 768px) {\r\n  .aplayer {\r\n    bottom: 80% !important;\r\n    max-width: calc(100vw - 20px);\r\n    min-width: auto;\r\n\r\n    &.aplayer-narrow {\r\n      bottom: 80% !important;\r\n    }\r\n  }\r\n}\r\n\r\n// 平板端调整\r\n@media screen and (max-width: 640px) {\r\n  .aplayer-body {\r\n    height: 58px;\r\n  }\r\n\r\n  .aplayer-pic {\r\n    width: 58px;\r\n    height: 58px;\r\n  }\r\n\r\n  .aplayer-info {\r\n    padding: 7px 12px 9px 12px;\r\n  }\r\n}\r\n\r\n// 移动端\r\n@media screen and (max-width: 480px) {\r\n  .aplayer-body {\r\n    height: 54px;\r\n  }\r\n\r\n  .aplayer-pic {\r\n    .aplayer-author {\r\n      font-size: 11px;\r\n    }\r\n  }\r\n\r\n  .aplayer-time {\r\n    .aplayer-time-inner {\r\n      margin-right: 5px;\r\n    }\r\n  }\r\n\r\n  .aplayer-order {\r\n    width: 13px;\r\n    height: 13px;\r\n    font-size: 10px;\r\n  }\r\n}\r\n\r\n// 小屏移动端\r\n@media screen and (max-width: 390px) {\r\n  .aplayer-body {\r\n    height: 50px;\r\n  }\r\n\r\n  .aplayer-pic {\r\n    width: 50px;\r\n    height: 50px;\r\n  }\r\n\r\n  .aplayer-info {\r\n    padding: 4px 10px 6px 10px;\r\n  }\r\n\r\n  .aplayer-music {\r\n    .aplayer-title {\r\n      font-size: 12px;\r\n    }\r\n\r\n    .aplayer-author {\r\n      font-size: 10px;\r\n    }\r\n  }\r\n}\r\n\r\n// 极小屏幕\r\n@media screen and (max-width: 320px) {\r\n  .aplayer-body {\r\n    height: 46px;\r\n  }\r\n\r\n  .aplayer-pic {\r\n    width: 46px;\r\n    height: 46px;\r\n  }\r\n\r\n  .aplayer-info {\r\n    padding: 3px 8px 5px 8px;\r\n  }\r\n\r\n  .aplayer-order {\r\n    display: none;\r\n  }\r\n}\r\n'],sourceRoot:''}]);const o=A},151:(e,r,a)=>{var t=a(123);t.__esModule&&(t=t.default),'string'==typeof t&&(t=[[e.id,t,'']]),t.locals&&(e.exports=t.locals);(0,a(424).A)('c608b1c2',t,!1,{ssrId:!0})},424:(e,r,a)=>{function t(e,r){for(var a=[],t={},n=0;n<r.length;n++){var i=r[n],A=i[0],o={id:e+':'+n,css:i[1],media:i[2],sourceMap:i[3]};t[A]?t[A].parts.push(o):a.push(t[A]={id:A,parts:[o]})}return a}a.d(r,{A:()=>C});var n='undefined'!=typeof document;if('undefined'!=typeof DEBUG&&DEBUG&&!n)throw new Error('vue-style-loader cannot be used in a non-browser environment. Use { target: \'node\' } in your Webpack config to indicate a server-rendering environment.');var i={},A=n&&(document.head||document.getElementsByTagName('head')[0]),o=null,l=0,s=!1,p=function(){},d=null,c='data-vue-ssr-id',u='undefined'!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function C(e,r,a,n){s=a,d=n||{};var A=t(e,r);return m(A),function(r){for(var a=[],n=0;n<A.length;n++){var o=A[n];(l=i[o.id]).refs--,a.push(l)}r?m(A=t(e,r)):A=[];for(n=0;n<a.length;n++){var l;if(0===(l=a[n]).refs){for(var s=0;s<l.parts.length;s++)l.parts[s]();delete i[l.id]}}}}function m(e){for(var r=0;r<e.length;r++){var a=e[r],t=i[a.id];if(t){t.refs++;for(var n=0;n<t.parts.length;n++)t.parts[n](a.parts[n]);for(;n<a.parts.length;n++)t.parts.push(y(a.parts[n]));t.parts.length>a.parts.length&&(t.parts.length=a.parts.length)}else{var A=[];for(n=0;n<a.parts.length;n++)A.push(y(a.parts[n]));i[a.id]={id:a.id,refs:1,parts:A}}}}function h(){var e=document.createElement('style');return e.type='text/css',A.appendChild(e),e}function y(e){var r,a,t=document.querySelector('style['+c+'~="'+e.id+'"]');if(t){if(s)return p;t.parentNode.removeChild(t)}if(u){var n=l++;t=o||(o=h()),r=f.bind(null,t,n,!1),a=f.bind(null,t,n,!0)}else t=h(),r=x.bind(null,t),a=function(){t.parentNode.removeChild(t)};return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else a()}}var g,v=(g=[],function(e,r){return g[e]=r,g.filter(Boolean).join('\n')});function f(e,r,a,t){var n=a?'':t.css;if(e.styleSheet)e.styleSheet.cssText=v(r,n);else{var i=document.createTextNode(n),A=e.childNodes;A[r]&&e.removeChild(A[r]),A.length?e.insertBefore(i,A[r]):e.appendChild(i)}}function x(e,r){var a=r.css,t=r.media,n=r.sourceMap;if(t&&e.setAttribute('media',t),d.ssrId&&e.setAttribute(c,r.id),n&&(a+='\n/*# sourceURL='+n.sources[0]+' */',a+='\n/*# sourceMappingURL=data:application/json;base64,'+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+' */'),e.styleSheet)e.styleSheet.cssText=a;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(a))}}},497:(e,r,a)=>{a.r(r),a.d(r,{default:()=>o});var t=a(790),n=a.n(t),i=a(54),A=a.n(i)()(n());A.push([e.id,'.aplayer-control[data-v-625c8d59]{display:flex;align-items:center;gap:1px;flex-shrink:0}.aplayer-control-btn[data-v-625c8d59]{appearance:none;-webkit-appearance:none;background-color:rgba(0,0,0,0) !important;border:none;padding:0;margin:0;outline:none;width:24px;height:24px;font-size:14px;color:#666;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s ease}.aplayer-control-btn[data-v-625c8d59]:hover{color:#b7daff}.aplayer-control-btn.active[data-v-625c8d59]{color:#b7daff}.fa-play[data-v-625c8d59]{width:8.75px}','',{version:3,sources:['webpack://./src/Aplayer_imitation/components/PlayerControls.vue'],names:[],mappings:'AACA,kCACE,YAAA,CACA,kBAAA,CACA,OAAA,CACA,aAAA,CAGF,sCACE,eAAA,CACA,uBAAA,CACA,yCAAA,CACA,WAAA,CACA,SAAA,CACA,QAAA,CACA,YAAA,CACA,UAAA,CACA,WAAA,CACA,cAAA,CACA,UAAA,CACA,cAAA,CACA,YAAA,CACA,kBAAA,CACA,sBAAA,CAEA,uBAAA,CAEA,4CACE,aAAA,CAGF,6CACE,aAAA,CAIJ,0BACE,YAAA',sourcesContent:['\r\n.aplayer-control {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 1px;\r\n  flex-shrink: 0;\r\n}\r\n\r\n.aplayer-control-btn {\r\n  appearance: none;\r\n  -webkit-appearance: none;\r\n  background-color: transparent !important;\r\n  border: none;\r\n  padding: 0;\r\n  margin: 0;\r\n  outline: none;\r\n  width: 24px;\r\n  height: 24px;\r\n  font-size: 14px;\r\n  color: #666;\r\n  cursor: pointer;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n\r\n  transition: all 0.2s ease;\r\n\r\n  &:hover {\r\n    color: #b7daff;\r\n  }\r\n\r\n  &.active {\r\n    color: #b7daff;\r\n  }\r\n}\r\n\r\n.fa-play {\r\n  width: 8.75px;\r\n}\r\n'],sourceRoot:''}]);const o=A},553:(e,r,a)=>{a.r(r),a.d(r,{default:()=>o});var t=a(790),n=a.n(t),i=a(54),A=a.n(i)()(n());A.push([e.id,'.aplayer-list[data-v-a2dd2a0e]{position:absolute;bottom:100%;left:0;right:0;background:#fff;box-shadow:0 -2px 8px rgba(0,0,0,.1);max-height:0;overflow-y:auto;transition:max-height .5s ease;margin-right:18px}.aplayer-list.aplayer-list-show[data-v-a2dd2a0e]{max-height:300px}.aplayer-list .aplayer-list-ol[data-v-a2dd2a0e]{list-style-type:none;margin:0;padding:0}.aplayer-list .aplayer-list-light[data-v-a2dd2a0e]{position:relative;height:32px;line-height:32px;padding:0 10px;font-size:15px;border-top:1px solid #e9e9e9;cursor:pointer;transition:all .3s ease;overflow:hidden;margin:0;display:flex;align-items:center}.aplayer-list .aplayer-list-light[data-v-a2dd2a0e]:first-child{border-top:none}.aplayer-list .aplayer-list-light[data-v-a2dd2a0e]:hover{background:#efefef}.aplayer-list .aplayer-list-light.aplayer-list-cur[data-v-a2dd2a0e]{background:#e6f3ff !important;border-left:4px solid #258bc9}.aplayer-list .aplayer-list-index[data-v-a2dd2a0e]{color:#666;margin-right:12px;cursor:pointer;width:15px;font-size:14px}.aplayer-list .aplayer-list-title[data-v-a2dd2a0e]{color:#666;flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;margin-right:10px;font-size:12px}.aplayer-list .aplayer-list-author[data-v-a2dd2a0e]{color:#ccc;font-size:12px}.aplayer-list[data-v-a2dd2a0e]::-webkit-scrollbar{width:5px}.aplayer-list[data-v-a2dd2a0e]::-webkit-scrollbar-track{background:#f1f1f1}.aplayer-list[data-v-a2dd2a0e]::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:4px}.aplayer-list[data-v-a2dd2a0e]::-webkit-scrollbar-thumb:hover{background:#a8a8a8}@media screen and (max-width:768px){.aplayer-list[data-v-a2dd2a0e]{top:100%;bottom:auto;box-shadow:0 2px 8px rgba(0,0,0,.1)}}','',{version:3,sources:['webpack://./src/Aplayer_imitation/components/PlayList.vue'],names:[],mappings:'AACA,+BACE,iBAAA,CACA,WAAA,CACA,MAAA,CACA,OAAA,CACA,eAAA,CACA,oCAAA,CACA,YAAA,CACA,eAAA,CACA,8BAAA,CACA,iBAAA,CAEA,iDACE,gBAAA,CAGF,gDACE,oBAAA,CACA,QAAA,CACA,SAAA,CAGF,mDACE,iBAAA,CACA,WAAA,CACA,gBAAA,CACA,cAAA,CACA,cAAA,CACA,4BAAA,CACA,cAAA,CACA,uBAAA,CACA,eAAA,CACA,QAAA,CACA,YAAA,CACA,kBAAA,CAEA,+DACE,eAAA,CAGF,yDACE,kBAAA,CAGF,oEACE,6BAAA,CACA,6BAAA,CAIJ,mDACE,UAAA,CACA,iBAAA,CACA,cAAA,CACA,UAAA,CACA,cAAA,CAGF,mDACE,UAAA,CACA,MAAA,CACA,eAAA,CACA,sBAAA,CACA,kBAAA,CACA,iBAAA,CACA,cAAA,CAGF,oDACE,UAAA,CACA,cAAA,CAGF,kDACE,SAAA,CAGF,wDACE,kBAAA,CAGF,wDACE,kBAAA,CACA,iBAAA,CAEA,8DACE,kBAAA,CAKN,oCACE,+BACE,QAAA,CACA,WAAA,CACA,mCAAA,CAAA',sourcesContent:['\r\n.aplayer-list {\r\n  position: absolute;\r\n  bottom: 100%;\r\n  left: 0;\r\n  right: 0;\r\n  background: #fff;\r\n  box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.1);\r\n  max-height: 0;\r\n  overflow-y: auto;\r\n  transition: max-height 0.5s ease;\r\n  margin-right: 18px;\r\n\r\n  &.aplayer-list-show {\r\n    max-height: 300px;\r\n  }\r\n\r\n  .aplayer-list-ol {\r\n    list-style-type: none;\r\n    margin: 0;\r\n    padding: 0;\r\n  }\r\n\r\n  .aplayer-list-light {\r\n    position: relative;\r\n    height: 32px;\r\n    line-height: 32px;\r\n    padding: 0 10px;\r\n    font-size: 15px;\r\n    border-top: 1px solid #e9e9e9;\r\n    cursor: pointer;\r\n    transition: all 0.3s ease;\r\n    overflow: hidden;\r\n    margin: 0;\r\n    display: flex;\r\n    align-items: center;\r\n\r\n    &:first-child {\r\n      border-top: none;\r\n    }\r\n\r\n    &:hover {\r\n      background: #efefef;\r\n    }\r\n\r\n    &.aplayer-list-cur {\r\n      background: #e6f3ff !important;\r\n      border-left: 4px solid #258bc9;\r\n    }\r\n  }\r\n\r\n  .aplayer-list-index {\r\n    color: #666;\r\n    margin-right: 12px;\r\n    cursor: pointer;\r\n    width: 15px;\r\n    font-size: 14px;\r\n  }\r\n\r\n  .aplayer-list-title {\r\n    color: #666;\r\n    flex: 1;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n    white-space: nowrap;\r\n    margin-right: 10px;\r\n    font-size: 12px;\r\n  }\r\n\r\n  .aplayer-list-author {\r\n    color: #ccc;\r\n    font-size: 12px;\r\n  }\r\n\r\n  &::-webkit-scrollbar {\r\n    width: 5px;\r\n  }\r\n\r\n  &::-webkit-scrollbar-track {\r\n    background: #f1f1f1;\r\n  }\r\n\r\n  &::-webkit-scrollbar-thumb {\r\n    background: #c1c1c1;\r\n    border-radius: 4px;\r\n\r\n    &:hover {\r\n      background: #a8a8a8;\r\n    }\r\n  }\r\n}\r\n\r\n@media screen and (max-width: 768px) {\r\n  .aplayer-list {\r\n    top: 100%;\r\n    bottom: auto;\r\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\r\n  }\r\n}\r\n'],sourceRoot:''}]);const o=A},565:(e,r,a)=>{var t=a(553);t.__esModule&&(t=t.default),'string'==typeof t&&(t=[[e.id,t,'']]),t.locals&&(e.exports=t.locals);(0,a(424).A)('07a8a353',t,!1,{ssrId:!0})},650:(e,r,a)=>{var t=a(758);t.__esModule&&(t=t.default),'string'==typeof t&&(t=[[e.id,t,'']]),t.locals&&(e.exports=t.locals);(0,a(424).A)('09da3f6e',t,!1,{ssrId:!0})},653:(e,r,a)=>{var t=a(497);t.__esModule&&(t=t.default),'string'==typeof t&&(t=[[e.id,t,'']]),t.locals&&(e.exports=t.locals);(0,a(424).A)('9e4f2790',t,!1,{ssrId:!0})},758:(e,r,a)=>{a.r(r),a.d(r,{default:()=>o});var t=a(790),n=a.n(t),i=a(54),A=a.n(i)()(n());A.push([e.id,'.aplayer-volume-wrap[data-v-6d01fe2c]{position:relative;display:inline-block;margin-right:7px}.aplayer-volume-button[data-v-6d01fe2c]{background:none;border:none;outline:none;cursor:pointer;color:#999;font-size:11px;padding:0;transition:all .2s ease;width:15px;height:15px;display:flex;align-items:center;justify-content:center}.aplayer-volume-button[data-v-6d01fe2c]:hover{color:#b7daff}.aplayer-volume-bar-wrap[data-v-6d01fe2c]{position:absolute;bottom:15px;right:-3px;width:25px;height:36px;z-index:99;opacity:0;visibility:hidden;transition:all .3s ease-in-out}.aplayer-volume-wrap:hover .aplayer-volume-bar-wrap[data-v-6d01fe2c]{opacity:1;visibility:visible}.aplayer-volume-bar[data-v-6d01fe2c]{position:relative;width:5px;height:100%;background:#aaa;cursor:pointer;margin:0 auto;overflow:hidden;border-radius:2px;-webkit-user-select:none;user-select:none;touch-action:none;-webkit-user-drag:none;-webkit-touch-callout:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}.aplayer-volume[data-v-6d01fe2c]{position:absolute;bottom:0;right:0;width:5px;transition:all .3s ease;background:#b7daff;height:70%}@media screen and (max-width:768px){.aplayer-volume-wrap[data-v-6d01fe2c]{display:none !important}}','',{version:3,sources:['webpack://./src/Aplayer_imitation/components/VolumeControl.vue'],names:[],mappings:'AACA,sCACE,iBAAA,CACA,oBAAA,CACA,gBAAA,CAGF,wCACE,eAAA,CACA,WAAA,CACA,YAAA,CACA,cAAA,CACA,UAAA,CACA,cAAA,CACA,SAAA,CACA,uBAAA,CACA,UAAA,CACA,WAAA,CACA,YAAA,CACA,kBAAA,CACA,sBAAA,CAEA,8CACE,aAAA,CAIJ,0CACE,iBAAA,CACA,WAAA,CACA,UAAA,CACA,UAAA,CACA,WAAA,CACA,UAAA,CACA,SAAA,CACA,iBAAA,CACA,8BAAA,CAGF,qEACE,SAAA,CACA,kBAAA,CAGF,qCACE,iBAAA,CACA,SAAA,CACA,WAAA,CACA,eAAA,CACA,cAAA,CACA,aAAA,CACA,eAAA,CACA,iBAAA,CACA,wBAAA,CAAA,gBAAA,CACA,iBAAA,CACA,sBAAA,CACA,0BAAA,CACA,yCAAA,CAGF,iCACE,iBAAA,CACA,QAAA,CACA,OAAA,CACA,SAAA,CACA,uBAAA,CACA,kBAAA,CACA,UAAA,CAIF,oCACE,sCACE,uBAAA,CAAA',sourcesContent:['\n.aplayer-volume-wrap {\n  position: relative;\n  display: inline-block;\n  margin-right: 7px;\n}\n\n.aplayer-volume-button {\n  background: none;\n  border: none;\n  outline: none;\n  cursor: pointer;\n  color: #999;\n  font-size: 11px;\n  padding: 0;\n  transition: all 0.2s ease;\n  width: 15px;\n  height: 15px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  &:hover {\n    color: #b7daff;\n  }\n}\n\n.aplayer-volume-bar-wrap {\n  position: absolute;\n  bottom: 15px;\n  right: -3px;\n  width: 25px;\n  height: 36px;\n  z-index: 99;\n  opacity: 0;\n  visibility: hidden;\n  transition: all 0.3s ease-in-out;\n}\n\n.aplayer-volume-wrap:hover .aplayer-volume-bar-wrap {\n  opacity: 1;\n  visibility: visible;\n}\n\n.aplayer-volume-bar {\n  position: relative;\n  width: 5px;\n  height: 100%;\n  background: #aaa;\n  cursor: pointer;\n  margin: 0 auto;\n  overflow: hidden;\n  border-radius: 2px;\n  user-select: none; // 防止拖动时选中文本\n  touch-action: none;\n  -webkit-user-drag: none;\n  -webkit-touch-callout: none;\n  -webkit-tap-highlight-color: transparent;\n}\n\n.aplayer-volume {\n  position: absolute;\n  bottom: 0;\n  right: 0;\n  width: 5px;\n  transition: all 0.3s ease;\n  background: #b7daff;\n  height: 70%;\n}\n\n// 移动端隐藏音量控制\n@media screen and (max-width: 768px) {\n  .aplayer-volume-wrap {\n    display: none !important;\n  }\n}\n'],sourceRoot:''}]);const o=A},790:e=>{e.exports=function(e){var r=e[1],a=e[3];if(!a)return r;if('function'==typeof btoa){var t=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),n='sourceMappingURL=data:application/json;charset=utf-8;base64,'.concat(t),i='/*# '.concat(n,' */');return[r].concat([i]).join('\n')}return[r].join('\n')}},953:(e,r,a)=>{a.r(r),a.d(r,{default:()=>o});var t=a(790),n=a.n(t),i=a(54),A=a.n(i)()(n());A.push([e.id,'.aplayer-bar-wrap[data-v-b5bb32c0]{flex:1;margin-right:7px;padding:4px 0;cursor:pointer}.aplayer-bar[data-v-b5bb32c0]{position:relative;height:2px;width:100%;background:#cdcdcd;cursor:pointer;border-radius:1px}.aplayer-loaded[data-v-b5bb32c0]{position:absolute;left:0;top:0;bottom:0;background:#aaa;height:2px;transition:all .5s ease;width:0;border-radius:1px}.aplayer-played[data-v-b5bb32c0]{position:absolute;left:0;top:0;bottom:0;height:2px;width:0;border-radius:1px;background:#b7daff;transition:all .1s ease}.aplayer-thumb[data-v-b5bb32c0]{position:absolute;top:50%;right:-4px;margin-top:-4px;height:8px;width:8px;border-radius:50%;cursor:pointer;transition:all .3s ease;transform:scale(0);opacity:0;background:#b7daff}.aplayer-bar-wrap:hover .aplayer-thumb[data-v-b5bb32c0]{transform:scale(1);opacity:1}','',{version:3,sources:['webpack://./src/Aplayer_imitation/components/ProgressBar.vue'],names:[],mappings:'AACA,mCACE,MAAA,CACA,gBAAA,CACA,aAAA,CACA,cAAA,CAGF,8BACE,iBAAA,CACA,UAAA,CACA,UAAA,CACA,kBAAA,CACA,cAAA,CACA,iBAAA,CAGF,iCACE,iBAAA,CACA,MAAA,CACA,KAAA,CACA,QAAA,CACA,eAAA,CACA,UAAA,CACA,uBAAA,CACA,OAAA,CACA,iBAAA,CAGF,iCACE,iBAAA,CACA,MAAA,CACA,KAAA,CACA,QAAA,CACA,UAAA,CACA,OAAA,CACA,iBAAA,CACA,kBAAA,CACA,uBAAA,CAGF,gCACE,iBAAA,CACA,OAAA,CACA,UAAA,CACA,eAAA,CACA,UAAA,CACA,SAAA,CACA,iBAAA,CACA,cAAA,CACA,uBAAA,CACA,kBAAA,CACA,SAAA,CACA,kBAAA,CAGF,wDACE,kBAAA,CACA,SAAA',sourcesContent:['\r\n.aplayer-bar-wrap {\r\n  flex: 1;\r\n  margin-right: 7px;\r\n  padding: 4px 0;\r\n  cursor: pointer;\r\n}\r\n\r\n.aplayer-bar {\r\n  position: relative;\r\n  height: 2px;\r\n  width: 100%;\r\n  background: #cdcdcd;\r\n  cursor: pointer;\r\n  border-radius: 1px;\r\n}\r\n\r\n.aplayer-loaded {\r\n  position: absolute;\r\n  left: 0;\r\n  top: 0;\r\n  bottom: 0;\r\n  background: #aaa;\r\n  height: 2px;\r\n  transition: all 0.5s ease;\r\n  width: 0;\r\n  border-radius: 1px;\r\n}\r\n\r\n.aplayer-played {\r\n  position: absolute;\r\n  left: 0;\r\n  top: 0;\r\n  bottom: 0;\r\n  height: 2px;\r\n  width: 0;\r\n  border-radius: 1px;\r\n  background: #b7daff;\r\n  transition: all 0.1s ease;\r\n}\r\n\r\n.aplayer-thumb {\r\n  position: absolute;\r\n  top: 50%;\r\n  right: -4px;\r\n  margin-top: -4px;\r\n  height: 8px;\r\n  width: 8px;\r\n  border-radius: 50%;\r\n  cursor: pointer;\r\n  transition: all 0.3s ease;\r\n  transform: scale(0);\r\n  opacity: 0;\r\n  background: #b7daff;\r\n}\r\n\r\n.aplayer-bar-wrap:hover .aplayer-thumb {\r\n  transform: scale(1);\r\n  opacity: 1;\r\n}\r\n'],sourceRoot:''}]);const o=A}},n={};function i(e){var r=n[e];if(void 0!==r)return r.exports;var a=n[e]={id:e,exports:{}};return t[e](a,a.exports,i),a.exports}i.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return i.d(r,{a:r}),r},i.d=(e,r)=>{for(var a in r)i.o(r,a)&&!i.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:r[a]})},i.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),i.r=e=>{'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(e,'__esModule',{value:!0})};const A=Vue,o=_.memoize(e=>{if(!e||isNaN(e))return{minutes:'00',seconds:'00',full:'00:00'};const r=Math.floor(e/60),a=Math.floor(e%60),t=r.toString().padStart(2,'0'),n=a.toString().padStart(2,'0');return{minutes:t,seconds:n,full:`${t}:${n}`}}),l=(e,r)=>!r||isNaN(r)||e<0||isNaN(e)?0:_.clamp(e/r*100,0,100),s=(e,r)=>{if(e<=1)return 0;const a=_.range(e).filter(e=>e!==r);return _.sample(a)??0};class p{audio;eventListeners=new Map;constructor(){this.audio=new Audio,this.audio.preload='auto',this.bindAudioEvents()}bindAudioEvents(){['play','pause','ended','timeupdate','loadedmetadata','canplay','progress','error'].forEach(e=>{this.audio.addEventListener(e,r=>{this.emit(e,r)})})}on(e,r){this.eventListeners.has(e)||this.eventListeners.set(e,[]),this.eventListeners.get(e).push(r)}off(e,r){if(this.eventListeners.has(e))if(r){const a=this.eventListeners.get(e),t=a.indexOf(r);t>-1&&a.splice(t,1)}else this.eventListeners.delete(e)}emit(e,r){const a=this.eventListeners.get(e);a&&a.forEach(e=>e(r))}async loadTrack(e){return new Promise((r,a)=>{this.audio.pause(),this.audio.currentTime=0,this.audio.removeAttribute('src'),this.audio.load(),this.audio.src=e.url;const t=()=>{this.audio.removeEventListener('canplay',t),this.audio.removeEventListener('error',n),r()},n=r=>{this.audio.removeEventListener('canplay',t),this.audio.removeEventListener('error',n),a(new Error(`音频加载失败: ${e.name}`))};this.audio.addEventListener('canplay',t,{once:!0}),this.audio.addEventListener('error',n,{once:!0})})}async play(){if(!(this.audio.readyState>=2))return new Promise((e,r)=>{const a=async()=>{this.audio.removeEventListener('canplay',a);try{await this.audio.play(),e()}catch(e){r(new Error(`播放失败: ${e}`))}};this.audio.addEventListener('canplay',a,{once:!0})});try{await this.audio.play()}catch(e){throw console.error('播放失败:',e),e}}pause(){this.audio.pause()}seek(e){this.audio.currentTime=e}setVolume(e){this.audio.volume=Math.max(0,Math.min(1,e))}get currentTime(){return this.audio.currentTime||0}get duration(){return this.audio.duration||0}get buffered(){const e=this.audio.buffered;return e.length>0?e.end(e.length-1):0}get volume(){return this.audio.volume}get paused(){return this.audio.paused}get ended(){return this.audio.ended}get formattedCurrentTime(){return o(this.currentTime)}get formattedDuration(){return o(this.duration)}destroy(){this.pause(),this.audio.removeAttribute('src'),this.audio.load(),this.eventListeners.clear()}}const d=[{name:'String Theocracy',artist:'Mili',url:'https://gitgud.io/yoyo514/elegy-for-the-end/-/raw/master/music/String%20Theocracy%EF%BC%88%E7%A5%9E%E6%9D%83%E6%94%BF%E6%B2%BB%E4%B9%8B%E7%BB%B3%EF%BC%89Library%20of%20Ruina%20-%20Mili.mp3',cover:'https://p2.music.126.net/uSA7KUpo8rCGvK5z5VvXiA==/109951167104512763.jpg?param=140y140'},{name:'Sis Puella Magica Orchestra',artist:'Música Melódica',url:'https://gitgud.io/yoyo514/elegy-for-the-end/-/raw/master/music/Sis%20Puella%20Magica%20Orchestra%20-%20M%C3%BAsica%20Mel%C3%B3dica.mp3',cover:'https://p2.music.126.net/BRkOispUjB7V_lxC990G7A==/109951166086738670.jpg?param=140y140'},{name:'业火的红莲',artist:'逆理的钢琴师',url:'https://gitgud.io/yoyo514/elegy-for-the-end/-/raw/master/music/%E4%B8%9A%E7%81%AB%E7%9A%84%E7%BA%A2%E8%8E%B2%20-%20%E9%80%86%E7%90%86%E7%9A%84%E9%92%A2%E7%90%B4%E5%B8%88.mp3',cover:'http://p2.music.126.net/LMZ6VWw5hil_odFv6MGYXQ==/109951169607637648.jpg?param=140y140'},{name:'カスカナヒカリ',artist:'藤間仁',url:'https://gitgud.io/yoyo514/elegy-for-the-end/-/raw/master/music/%E3%82%AB%E3%82%B9%E3%82%AB%E3%83%8A%E3%83%92%E3%82%AB%E3%83%AA%20-%20%E8%97%A4%E9%96%93%E4%BB%81.mp3',cover:'https://cf.mora.jp/contents/package/0000/00000284/0009/354/490/0009354490.200.jpg'},{name:'DEEP (深渊)',artist:'Pianoboy高至豪',url:'http://gitgud.io/yoyo514/elegy-for-the-end/-/raw/master/music/DEEP%20(%E6%B7%B1%E6%B8%8A)%20-%20Pianoboy%E9%AB%98%E8%87%B3%E8%B1%AA.mp3',cover:'https://p1.music.126.net/KS1iNTS-9csOTzew3kFm5w==/109951165414795064.jpg?param=200y200'},{name:'Light Above The Sky',artist:'Delos',url:'https://gitgud.io/yoyo514/elegy-for-the-end/-/raw/master/music/Light%20Above%20The%20Sky%20-%20Delos.mp3',cover:'https://p2.music.126.net/82DoOe7CoKlkrze7k4gyOQ==/109951163708382315.jpg?param=140y140'},{name:'无人之地',artist:'UM',url:'https://gitgud.io/yoyo514/elegy-for-the-end/-/raw/master/music/%E6%97%A0%E4%BA%BA%E4%B9%8B%E5%9C%B0%20-%20UM.mp3',cover:'https://p1.music.126.net/ImfmFqhrVtvSi0v7LYSKGQ==/109951169790490991.jpg?param=140y140'},{name:'逆洄',artist:'alpaca咕噜',url:'https://gitgud.io/yoyo514/elegy-for-the-end/-/raw/master/music/%E9%80%86%E6%B4%84%20-%20alpaca%E5%92%95%E5%99%9C.mp3',cover:'https://p2.music.126.net/BqJv2QRfRm4OS9j0sbWRAg==/109951170257467059.jpg?param=140y140'},{name:'化蝶轻岚境',artist:'MoFeansy沐风',url:'https://gitgud.io/yoyo514/elegy-for-the-end/-/raw/master/music/%E5%8C%96%E8%9D%B6%E8%BD%BB%E5%B2%9A%E5%A2%83%20-%20MoFeansy%E6%B2%90%E9%A3%8E.mp3',cover:'https://img1.kuwo.cn/star/albumcover/500/s4s24/97/4272800514.png'},{name:'海鸣',artist:'路灰气球',url:'https://gitgud.io/yoyo514/elegy-for-the-end/-/raw/master/music/%E6%B5%B7%E9%B8%A3%20-%20%E8%B7%AF%E7%81%B0%E6%B0%94%E7%90%83.mp3',cover:'https://p2.music.126.net/YU9RRPiWMFMXRPr-nMY4BQ==/109951168882397092.jpg?param=140y140'},{name:'活着就是一种伟大',artist:'Maple暖枫',url:'https://gitgud.io/yoyo514/elegy-for-the-end/-/raw/master/music/%E6%B4%BB%E7%9D%80%E5%B0%B1%E6%98%AF%E4%B8%80%E7%A7%8D%E4%BC%9F%E5%A4%A7%20-%20Maple%E6%9A%96%E6%9E%AB.mp3',cover:'http://p1.music.126.net/QeXscV_m8uriJ-rt6EQPZQ==/109951168939820951.jpg?param=140y140'},{name:'Lily',artist:'Binary Haze Interactive/Mili',url:'https://gitgud.io/yoyo514/elegy-for-the-end/-/raw/master/music/Lily%20-%20Binary%20Haze%20Interactive&Mili.mp3',cover:'https://p2.music.126.net/cCXt0Rbny_HPiEKLNmA6Fw==/109951166057712738.jpg?param=140y140'},{name:'North',artist:'Binary Haze Interactive/Mili',url:'https://gitgud.io/yoyo514/elegy-for-the-end/-/raw/master/music/North%20-%20Binary%20Haze%20Interactive&Mili.mp3',cover:'https://p2.music.126.net/cCXt0Rbny_HPiEKLNmA6Fw==/109951166057712738.jpg?param=140y140'},{name:'Harmonious',artist:'Binary Haze Interactive/Mili',url:'https://gitgud.io/yoyo514/elegy-for-the-end/-/raw/master/music/Harmonious%20-%20Binary%20Haze%20Interactive&Mili.mp3',cover:'https://p2.music.126.net/cCXt0Rbny_HPiEKLNmA6Fw==/109951166057712738.jpg?param=140y140'},{name:'Mother - Outro',artist:'Binary Haze Interactive/Mili',url:'https://gitgud.io/yoyo514/elegy-for-the-end/-/raw/master/music/Mother%20-%20Outro%20-%20Binary%20Haze%20Interactive&Mili.mp3',cover:'https://p2.music.126.net/cCXt0Rbny_HPiEKLNmA6Fw==/109951166057712738.jpg?param=140y140'}];var c,u,C;!function(e){e.LIST='list',e.RANDOM='random',e.REPEAT_ONE='repeat-one',e.NONE='none'}(c||(c={})),function(e){e.PLAY='play',e.PAUSE='pause',e.ENDED='ended',e.TIME_UPDATE='timeupdate',e.LOADED_METADATA='loadedmetadata',e.CAN_PLAY='canplay',e.PROGRESS='progress',e.ERROR='error'}(u||(u={})),function(e){e.UNLOADED='unloaded',e.LOADING='loading',e.LOADED='loaded',e.ERROR='error'}(C||(C={}));const m=r('player',()=>{const e=(0,A.ref)([...d]),r=(0,A.ref)(0),a=(0,A.ref)(!1),t=(0,A.ref)(.7),n=(0,A.ref)(.7),i=(0,A.ref)(c.LIST),o=(0,A.ref)(!1),l=(0,A.ref)(!0),p=(0,A.ref)(!1),u=(0,A.ref)(0),C=(0,A.ref)(0),m=(0,A.ref)(0),h=(0,A.computed)(()=>e.value[r.value]||null),y=(0,A.computed)(()=>e.value.length>1),g=(0,A.computed)(()=>e.value.length>1),v=(0,A.computed)(()=>C.value?u.value/C.value*100:0),f=(0,A.computed)(()=>C.value?m.value/C.value*100:0),x=(0,A.computed)(()=>0===t.value),b=(0,A.computed)(()=>({currentIndex:r.value,isPlaying:a.value,volume:t.value,previousVolume:n.value,order:i.value,isMinimized:o.value,listFolded:l.value,currentTime:u.value,duration:C.value,buffered:m.value})),E=a=>{a>=0&&a<e.value.length&&(r.value=a)},w=e=>{a.value=e},B=e=>{const r=Math.max(0,Math.min(1,e));t.value>0&&(n.value=t.value),t.value=r},k=e=>{u.value=e},N=e=>{C.value=e},S=e=>{m.value=e},P=()=>{switch(i.value){case c.RANDOM:return s(e.value.length,r.value);case c.REPEAT_ONE:return r.value;case c.NONE:return r.value>=e.value.length-1?r.value:r.value+1;case c.LIST:default:return(r.value+1)%e.value.length}},R=()=>{switch(i.value){case c.RANDOM:return s(e.value.length,r.value);case c.REPEAT_ONE:return r.value;case c.NONE:return r.value<=0?r.value:r.value-1;case c.LIST:default:return 0===r.value?e.value.length-1:r.value-1}};return{audioList:e,currentIndex:r,isPlaying:a,volume:t,previousVolume:n,order:i,isMinimized:o,listFolded:l,autoPlay:p,currentTime:u,duration:C,buffered:m,currentTrack:h,canSkipPrev:y,canSkipNext:g,progress:v,bufferedProgress:f,isMuted:x,playerState:b,setAudioList:a=>{e.value=[...a],r.value>=a.length&&(r.value=0)},setCurrentIndex:E,setPlaying:w,setVolume:B,toggleMute:()=>{t.value>0?B(0):B(n.value>0?n.value:1)},setOrder:e=>{i.value=e},toggleMinimized:()=>{o.value=!o.value},toggleList:()=>{l.value=!l.value},updateTime:k,updateDuration:N,updateBuffered:S,getNextIndex:P,getPrevIndex:R,skipToNext:()=>{const e=P();i.value!==c.NONE||e!==r.value?E(e):w(!1)},skipToPrev:()=>{const e=R();i.value!==c.NONE||e!==r.value?E(e):w(!1)},switchTo:e=>{E(e)},reset:()=>{w(!1),k(0),N(0),S(0)},initFromSettings:a=>{void 0!==a.defaultVolume&&(t.value=a.defaultVolume,n.value=a.defaultVolume),void 0!==a.defaultOrder&&(i.value=a.defaultOrder),void 0!==a.listFolded&&(l.value=a.listFolded),void 0!==a.isMinimized&&(o.value=a.isMinimized),void 0!==a.autoPlay&&(p.value=a.autoPlay),a.customAudioList&&Array.isArray(a.customAudioList)&&a.customAudioList.length>0&&(e.value=[...a.customAudioList],r.value>=a.customAudioList.length&&(r.value=0))},saveCurrentSettings:()=>{const r={defaultVolume:t.value,defaultOrder:i.value,autoPlay:p.value,listFolded:l.value,isMinimized:o.value,customAudioList:e.value};try{replaceVariables(r,{type:'script',script_id:getScriptId()})}catch(e){console.warn('[APlayer] 保存设置失败:',e)}}}});var h,y;!function(e){e.AUDIO_LOAD_ERROR='audio_load_error',e.AUDIO_PLAY_ERROR='audio_play_error',e.NETWORK_ERROR='network_error',e.PERMISSION_ERROR='permission_error',e.UNKNOWN_ERROR='unknown_error'}(h||(h={})),function(e){e.IDLE='idle',e.LOADING='loading',e.SUCCESS='success',e.ERROR='error'}(y||(y={}));class g{maxRetries;retryDelay;constructor(e=3,r=1e3){this.maxRetries=e,this.retryDelay=r}async execute(e,r){let a;for(let t=1;t<=this.maxRetries;t++)try{return await e()}catch(e){a=e,t<this.maxRetries&&(r?.(t,e),await this.delay(this.retryDelay*Math.pow(2,t-1)))}throw a}delay(e){return new Promise(r=>setTimeout(r,e))}}const v={class:'aplayer-control'},f=['disabled'],x=['title'],b={class:'fas fa-play'},E={class:'fas fa-pause'},w=['disabled'],B=(0,A.defineComponent)({__name:'PlayerControls',props:{isPlaying:{type:Boolean},canSkipPrev:{type:Boolean},canSkipNext:{type:Boolean}},emits:['play','pause','prev','next','toggle-list'],setup:e=>(r,a)=>((0,A.openBlock)(),(0,A.createElementBlock)('div',v,[(0,A.createElementVNode)('button',{class:'aplayer-prev aplayer-control-btn',disabled:!e.canSkipPrev,title:'上一首',onClick:a[0]||(a[0]=e=>r.$emit('prev'))},[...a[4]||(a[4]=[(0,A.createElementVNode)('i',{class:'fas fa-step-backward'},null,-1)])],8,f),(0,A.createElementVNode)('button',{class:'aplayer-play-btn aplayer-control-btn',title:e.isPlaying?'暂停':'播放',onClick:a[1]||(a[1]=a=>e.isPlaying?r.$emit('pause'):r.$emit('play'))},[(0,A.withDirectives)((0,A.createElementVNode)('i',b,null,512),[[A.vShow,!e.isPlaying]]),(0,A.withDirectives)((0,A.createElementVNode)('i',E,null,512),[[A.vShow,e.isPlaying]])],8,x),(0,A.createElementVNode)('button',{class:'aplayer-next aplayer-control-btn',disabled:!e.canSkipNext,title:'下一首',onClick:a[2]||(a[2]=e=>r.$emit('next'))},[...a[5]||(a[5]=[(0,A.createElementVNode)('i',{class:'fas fa-step-forward'},null,-1)])],8,w),(0,A.createElementVNode)('button',{class:'aplayer-menu aplayer-control-btn',title:'菜单',onClick:a[3]||(a[3]=e=>r.$emit('toggle-list'))},[...a[6]||(a[6]=[(0,A.createElementVNode)('i',{class:'fas fa-bars'},null,-1)])])]))});i(653);var k=i(42);const N=(0,k.A)(B,[['__scopeId','data-v-625c8d59']]),S={class:'aplayer-list-ol'},P=['onClick'],R={class:'aplayer-list-index'},M={class:'aplayer-list-title'},O={class:'aplayer-list-author'},D=(0,A.defineComponent)({__name:'PlayList',props:{tracks:{},currentIndex:{},isVisible:{type:Boolean}},emits:['select-track'],setup:e=>(r,a)=>((0,A.openBlock)(),(0,A.createElementBlock)('div',{class:(0,A.normalizeClass)(['aplayer-list',{'aplayer-list-show':e.isVisible}])},[(0,A.createElementVNode)('ol',S,[((0,A.openBlock)(!0),(0,A.createElementBlock)(A.Fragment,null,(0,A.renderList)(e.tracks,(a,t)=>((0,A.openBlock)(),(0,A.createElementBlock)('li',{key:`track-${t}-${a.name}`,class:(0,A.normalizeClass)(['aplayer-list-light',{'aplayer-list-cur':t===e.currentIndex}]),onClick:e=>r.$emit('select-track',t)},[(0,A.createElementVNode)('span',R,(0,A.toDisplayString)(t+1),1),(0,A.createElementVNode)('span',M,(0,A.toDisplayString)(a.name),1),(0,A.createElementVNode)('span',O,(0,A.toDisplayString)(a.artist),1)],10,P))),128))])],2))});i(565);const I=(0,k.A)(D,[['__scopeId','data-v-a2dd2a0e']]),V=(0,A.defineComponent)({__name:'ProgressBar',props:{currentTime:{},duration:{},buffered:{}},emits:['seek'],setup(e,{emit:r}){const a=e,t=r,n=(0,A.ref)(),i=(0,A.computed)(()=>l(a.currentTime,a.duration)),o=(0,A.computed)(()=>l(a.buffered,a.duration)),s=e=>{if(!n.value||!a.duration)return;const r=n.value.getBoundingClientRect(),i=(e.clientX-r.left)/r.width*a.duration;t('seek',Math.max(0,Math.min(a.duration,i)))};return(e,r)=>((0,A.openBlock)(),(0,A.createElementBlock)('div',{class:'aplayer-bar-wrap',onClick:s},[(0,A.createElementVNode)('div',{class:'aplayer-bar',ref_key:'barRef',ref:n},[(0,A.createElementVNode)('div',{class:'aplayer-loaded',style:(0,A.normalizeStyle)({width:`${o.value}%`})},null,4),(0,A.createElementVNode)('div',{class:'aplayer-played',style:(0,A.normalizeStyle)({width:`${i.value}%`})},[...r[0]||(r[0]=[(0,A.createElementVNode)('span',{class:'aplayer-thumb'},null,-1)])],4)],512)]))}});i(53);const T=(0,k.A)(V,[['__scopeId','data-v-b5bb32c0']]),L={class:'aplayer-volume-wrap'},F={class:'aplayer-volume-bar-wrap'},U=(0,A.defineComponent)({__name:'VolumeControl',props:{volume:{},isMuted:{type:Boolean}},emits:['volume-change','toggle-mute'],setup(e,{emit:r}){const a=e,t=r,n=(0,A.ref)(),i=(0,A.ref)(!1),o=(0,A.computed)(()=>100*a.volume),l=(0,A.computed)(()=>a.isMuted||0===a.volume?'fas fa-volume-off':a.volume>.5?'fas fa-volume-up':'fas fa-volume-down'),s=e=>{if(!n.value)return;const r=n.value.getBoundingClientRect(),a=r.height-10,i=e.clientY-r.top-5;let A;A=i<=0?1:i>=a?0:1-i/a;const o=Math.max(0,Math.min(1,A));t('volume-change',o)},p=e=>{i.value||(e.stopPropagation(),s(e))},d=e=>{if(!n.value)return;e.preventDefault(),e.stopPropagation(),i.value=!0,s(e);$(document).on('mousemove.volumeControl',e=>{if(!i.value)return;const r=e.originalEvent;s(r)}),$(document).on('mouseup.volumeControl',()=>{i.value=!1,$(document).off('mousemove.volumeControl mouseup.volumeControl'),setTimeout(()=>{i.value=!1},10)})};return(e,r)=>((0,A.openBlock)(),(0,A.createElementBlock)('span',L,[(0,A.createElementVNode)('button',{class:'aplayer-volume-button',onClick:r[0]||(r[0]=r=>e.$emit('toggle-mute'))},[(0,A.createElementVNode)('i',{class:(0,A.normalizeClass)(l.value)},null,2)]),(0,A.createElementVNode)('div',F,[(0,A.createElementVNode)('div',{class:'aplayer-volume-bar',ref_key:'volumeBarRef',ref:n,onMousedown:d,onClick:p},[(0,A.createElementVNode)('div',{class:'aplayer-volume',style:(0,A.normalizeStyle)({height:`${o.value}%`})},null,4)],544)])]))}});i(650);const G=(0,k.A)(U,[['__scopeId','data-v-6d01fe2c']]),j={class:'aplayer-body'},W={class:'fas fa-play'},Y={class:'fas fa-pause'},K=['src','alt'],Q={class:'aplayer-info'},q={class:'aplayer-info-top'},H={class:'aplayer-music'},J={class:'aplayer-title'},X={class:'aplayer-author'},Z={class:'aplayer-controller'},ee={class:'aplayer-time'},re={class:'aplayer-time-inner'},ae={class:'aplayer-ptime'},te={class:'aplayer-dtime'},ne=['title'],ie=(0,A.defineComponent)({__name:'MusicPlayer',setup(e){const r=m(),{audioList:t,currentIndex:n,isPlaying:i,volume:l,order:s,isMinimized:d,listFolded:C,autoPlay:v,currentTime:f,duration:x,buffered:b,canSkipPrev:E,canSkipNext:w,isMuted:B}=a(r);let k,S;const P=(()=>{const e=(0,A.ref)([]),r=(0,A.ref)(null),a=(0,A.ref)(y.IDLE),t=_.throttle(a=>{const t={...a,timestamp:Date.now()};e.value.unshift(t),r.value=t,e.value.length>10&&(e.value=e.value.slice(0,10)),setTimeout(()=>{r.value===t&&(r.value=null)},5e3),console.error('[APlayer Error]',t)},1e3),n=e=>{a.value=e};return{errors:e,currentError:r,loadingState:a,addError:t,clearCurrentError:()=>{r.value=null},clearAllErrors:()=>{e.value=[],r.value=null},setLoadingState:n,handleAudioLoadError:(e,r,a)=>{let i='音频加载失败',A=h.AUDIO_LOAD_ERROR;a&&(a.message?.includes('network')?(A=h.NETWORK_ERROR,i='网络连接失败，无法加载音频'):a.message?.includes('permission')&&(A=h.PERMISSION_ERROR,i='没有权限播放该音频')),t({type:A,message:`${i}: ${e}`,trackName:e,trackUrl:r}),n(y.ERROR)},handleAudioPlayError:(e,r)=>{let a='音频播放失败';r&&('NotAllowedError'===r.name?a='播放被浏览器阻止，请手动点击播放按钮':'NotSupportedError'===r.name&&(a='该音频格式不受支持')),t({type:h.AUDIO_PLAY_ERROR,message:`${a}: ${e}`,trackName:e})},handleNetworkError:(e='网络连接失败')=>{t({type:h.NETWORK_ERROR,message:e})},handleUnknownError:(e,r='未知操作')=>{t({type:h.UNKNOWN_ERROR,message:`${r}时发生未知错误: ${e?.message||'未知错误'}`})}}})(),{handleAudioLoadError:R,handleAudioPlayError:M,setLoadingState:O}=P,D=(0,A.ref)(''),V=(0,A.ref)(!1),L=(0,A.computed)(()=>o(f.value).full),F=(0,A.computed)(()=>o(x.value).full),U=(0,A.computed)(()=>r.currentTrack),ie=(0,A.computed)(()=>{switch(s.value){case c.LIST:return'列表循环';case c.RANDOM:return'随机播放';case c.REPEAT_ONE:return'单曲循环';case c.NONE:return'播完停止';default:return'列表循环'}}),Ae=(0,A.computed)(()=>{switch(s.value){case c.RANDOM:return'fas fa-random';case c.REPEAT_ONE:return'fas fa-redo-alt';case c.NONE:return'fas fa-arrow-right';default:return'fas fa-retweet'}}),oe=async()=>{const e=r.currentTrack;if(e)try{D.value===e.url&&0!==k.duration||(console.log('[APlayer] 播放前检测到音频未加载，先加载音频'),await pe()),O(y.LOADING),await S.execute(()=>k.play(),(e,r)=>{console.warn(`播放重试 ${e}/3:`,r)}),r.setPlaying(!0),O(y.SUCCESS),console.log('[APlayer] 播放成功:',e.name)}catch(a){console.error('[APlayer] 播放失败:',a),M(e.name,a),r.setPlaying(!1),O(y.ERROR)}},le=()=>{k.pause(),r.setPlaying(!1),console.log('[APlayer] 已暂停播放')},se=()=>{i.value?le():oe()},pe=async()=>{const e=r.currentTrack;if(e&&!V.value)if(D.value!==e.url){V.value=!0,console.log('[APlayer] 开始加载音频:',e.name,e.url);try{O(y.LOADING),r.updateTime(0),r.updateDuration(0),r.updateBuffered(0),await S.execute(()=>k.loadTrack(e),(r,a)=>{console.warn(`音频加载重试 ${r}/3:`,e?.name,a)}),D.value=e.url,O(y.SUCCESS),console.log('[APlayer] 音频加载成功:',e.name)}catch(r){console.error('[APlayer] 加载音频失败:',r),R(e.name,e.url,r),O(y.ERROR),D.value='',setTimeout(()=>ue(),1500)}finally{V.value=!1}}else console.log('[APlayer] 音频已加载，跳过重复加载:',e.name)},de=async(e=!1)=>{const a=r.currentTrack;a&&(console.log('[APlayer] 开始切换歌曲到:',a.name),le(),D.value='',await pe(),e&&await oe())},ce=async()=>{const e=i.value;console.log('[APlayer] 点击上一首，当前播放状态:',e),r.skipToPrev(),await de(e)},ue=async()=>{const e=i.value;console.log('[APlayer] 点击下一首，当前播放状态:',e),r.skipToNext(),await de(e)},Ce=async e=>{const a=i.value;console.log('[APlayer] 选择歌曲索引:',e,'当前播放状态:',a),console.log('[APlayer] 选择的歌曲:',t.value[e]?.name),r.switchTo(e),await de(a)},me=e=>{k.duration>0?k.seek(e):console.warn('[APlayer] 无法快进，音频尚未加载完成')},he=e=>{r.setVolume(e),k.setVolume(e)},ye=()=>{r.toggleMute(),k.setVolume(l.value)},ge=()=>{const e=[c.LIST,c.RANDOM,c.REPEAT_ONE,c.NONE],a=e.indexOf(s.value),t=e[(a+1)%e.length];r.setOrder(t)},ve=()=>{r.toggleList()},fe=()=>{r.toggleMinimized()},xe=async()=>{switch(s.value){case c.REPEAT_ONE:k.seek(0),await oe();break;case c.NONE:le();break;case c.RANDOM:case c.LIST:default:r.skipToNext(),await de(!0)}};return(0,A.onMounted)(()=>{k=new p,S=new g(3,1e3),k.on(u.TIME_UPDATE,()=>{r.updateTime(k.currentTime)}),k.on(u.LOADED_METADATA,()=>{r.updateDuration(k.duration)}),k.on(u.PROGRESS,()=>{r.updateBuffered(k.buffered)}),k.on(u.ENDED,xe),k.on(u.ERROR,e=>{console.error('[APlayer] 音频播放错误:',e),U.value&&R(U.value.name,U.value.url,e),setTimeout(()=>ue(),1500)}),k.setVolume(l.value),U.value&&pe().then(()=>{v.value&&oe()})}),(0,A.onUnmounted)(()=>{k&&k.destroy()}),(0,A.watch)(n,async(e,r)=>{e!==r&&k&&(D.value='',await pe())},{immediate:!1}),(0,A.watch)(l,e=>{k&&k.setVolume(e)}),(e,r)=>((0,A.openBlock)(),(0,A.createElementBlock)('div',{class:(0,A.normalizeClass)(['aplayer',{'aplayer-narrow':(0,A.unref)(d)}])},[(0,A.createCommentVNode)(' 播放列表 '),(0,A.createVNode)(I,{tracks:(0,A.unref)(t),'current-index':(0,A.unref)(n),'is-visible':!(0,A.unref)(C),onSelectTrack:Ce},null,8,['tracks','current-index','is-visible']),(0,A.createElementVNode)('div',j,[(0,A.createCommentVNode)(' 封面和播放按钮 '),(0,A.createElementVNode)('div',{class:(0,A.normalizeClass)(['aplayer-pic',{'aplayer-pic-playing':(0,A.unref)(i)}]),onClick:se},[(0,A.createElementVNode)('div',{class:(0,A.normalizeClass)(['aplayer-button',{'aplayer-button-playing':(0,A.unref)(i)}])},[(0,A.withDirectives)((0,A.createElementVNode)('i',W,null,512),[[A.vShow,!(0,A.unref)(i)]]),(0,A.withDirectives)((0,A.createElementVNode)('i',Y,null,512),[[A.vShow,(0,A.unref)(i)]])],2),(0,A.createElementVNode)('img',{class:'aplayer-pic-img',src:U.value?.cover,alt:U.value?.name||'封面'},null,8,K)],2),(0,A.createCommentVNode)(' 播放信息和控制 '),(0,A.createElementVNode)('div',Q,[(0,A.createElementVNode)('div',q,[(0,A.createCommentVNode)(' 歌曲信息 '),(0,A.createElementVNode)('div',H,[(0,A.createElementVNode)('span',J,(0,A.toDisplayString)(U.value?.name||'未知歌曲'),1),(0,A.createElementVNode)('span',X,' - '+(0,A.toDisplayString)(U.value?.artist||'未知艺术家'),1)]),(0,A.createCommentVNode)(' 控制按钮 '),(0,A.createVNode)(N,{'is-playing':(0,A.unref)(i),'can-skip-prev':(0,A.unref)(E),'can-skip-next':(0,A.unref)(w),onPlay:oe,onPause:le,onPrev:ce,onNext:ue,onToggleList:ve},null,8,['is-playing','can-skip-prev','can-skip-next'])]),(0,A.createElementVNode)('div',Z,[(0,A.createCommentVNode)(' 进度条 '),(0,A.createVNode)(T,{'current-time':(0,A.unref)(f),duration:(0,A.unref)(x),buffered:(0,A.unref)(b),onSeek:me},null,8,['current-time','duration','buffered']),(0,A.createCommentVNode)(' 时间和音量 '),(0,A.createElementVNode)('div',ee,[(0,A.createElementVNode)('span',re,[(0,A.createElementVNode)('span',ae,(0,A.toDisplayString)(L.value),1),r[0]||(r[0]=(0,A.createTextVNode)(' / ',-1)),(0,A.createElementVNode)('span',te,(0,A.toDisplayString)(F.value),1)]),(0,A.createVNode)(G,{volume:(0,A.unref)(l),'is-muted':(0,A.unref)(B),onVolumeChange:he,onToggleMute:ye},null,8,['volume','is-muted']),(0,A.createElementVNode)('button',{class:'aplayer-order',title:ie.value,onClick:ge},[(0,A.createElementVNode)('i',{class:(0,A.normalizeClass)(Ae.value)},null,2)],8,ne)])])]),(0,A.createCommentVNode)(' 收缩/展开按钮 '),(0,A.createElementVNode)('div',{class:'aplayer-miniswitcher'},[(0,A.createElementVNode)('button',{class:'aplayer-icon',onClick:fe},[...r[1]||(r[1]=[(0,A.createElementVNode)('svg',{xmlns:'http://www.w3.org/2000/svg',version:'1.1',viewBox:'0 0 32 32'},[(0,A.createElementVNode)('path',{d:'M22 16l-10.105-10.6-1.895 1.987 8.211 8.613-8.211 8.612 1.895 1.988 8.211-8.613z'})],-1)])])])])],2))}});i(151);const Ae=(0,k.A)(ie,[['__scopeId','data-v-1409529e']]),oe=z,le=oe.z.object({defaultVolume:oe.z.number().min(0).max(1).default(.7),defaultOrder:oe.z.enum(c).default(c.LIST),autoPlay:oe.z.boolean().default(!1),listFolded:oe.z.boolean().default(!0),isMinimized:oe.z.boolean().default(!1),customAudioList:oe.z.array(oe.z.object({name:oe.z.string(),artist:oe.z.string(),url:oe.z.url(),cover:oe.z.url().optional()})).optional()});class se{static instance=null;playerApp=null;container=null;piniaInstance=null;constructor(){this.bindGlobalEvents()}static getInstance(){return this.instance??=new se,this.instance}createPlayer=_.once((e=d)=>{try{this.cleanup(),this.initializeContainer(),this.createVueApplication(),this.handleStyleInjection(),this.applyUserSettings(),console.log('[APlayer] 播放器创建成功')}catch(e){this.handleError('创建播放器',e)}});destroyPlayer(){this.cleanup(),this.resetInstance(),console.log('[APlayer] 播放器已销毁')}initializeContainer(){$('#aplayer-container').length?this.container=$('#aplayer-container'):(this.container=$('<div>').attr('id','aplayer-container'),$('body').append(this.container))}createVueApplication(){this.piniaInstance=e(),this.playerApp=(0,A.createApp)(Ae),this.playerApp.use(this.piniaInstance),this.playerApp.mount(this.container[0])}handleStyleInjection=_.debounce(()=>{this.teleportStyle()},150);teleportStyle(){$(`head > div[script_id="${getScriptId()}"]`,window.parent.document).length||($('<div>').attr('script_id',getScriptId()).append($('head > style',document).clone()).appendTo($('head',window.parent.document)),console.log('[APlayer] 样式已注入到酒馆页面 <head>'))}deteleportStyle(){$(`head > div[script_id="${getScriptId()}"]`,window.parent.document).remove()}applyUserSettings(){try{const e=getVariables({type:'script',script_id:getScriptId()}),r=pe.processSettings(e);this.applySettingsToStore(r),console.log('[APlayer] 已加载播放器设置:',r)}catch(e){console.warn('[APlayer] 加载播放器设置失败，使用默认设置:',e),this.useDefaultSettings()}}applySettingsToStore(e){if(!this.piniaInstance)return void this.handleError('应用设置','Pinia 实例未初始化');const r=m(this.piniaInstance);r?.initFromSettings?r.initFromSettings(e):this.handleError('应用设置','Store 或 initFromSettings 方法不存在')}useDefaultSettings(){const e=le.parse({});pe.saveSettings(e)}cleanup(){this.playerApp&&(this.playerApp.unmount(),this.playerApp=null),this.container&&(this.container.remove(),this.container=null),this.piniaInstance=null,this.deteleportStyle(),$(document).off('click.aplayerVue')}resetInstance(){se.instance=null}bindGlobalEvents(){$(document).on('click.aplayerVue',this.handleOutsideClick),$(window).on('pagehide',()=>this.destroyPlayer())}handleOutsideClick=e=>{$(e.target).closest('#aplayer-container .aplayer-menu, #aplayer-container .aplayer-list').length||this.closePlaylistIfOpen()};closePlaylistIfOpen(){if(this.playerApp?._instance&&this.piniaInstance)try{const e=this.piniaInstance._s,r=e?.get('player');if(r&&!r.listFolded)return void r.toggleList()}catch(e){console.warn('[APlayer] 通过 store 关闭播放列表失败，使用 DOM 操作:',e)}const e=$('#aplayer-container .aplayer-list');e.hasClass('aplayer-list-show')&&e.removeClass('aplayer-list-show')}handleError=_.throttle((e,r)=>{const a=`[APlayer ${e}]: ${r?.message||r}`;console.error(a)},2e3)}const pe={saveSettings:_.debounce(e=>{replaceVariables(e,{type:'script',script_id:getScriptId()})},500),processSettings:_.flow([e=>{return r=e,le.parse(r);var r},e=>(pe.saveSettings(e),e)]),logError:_.throttle((e,r)=>{console.error(`[APlayer] ${e}:`,r)},1e3)};let de;const ce=(e=d)=>{de=se.getInstance(),de.createPlayer(e)},ue=()=>{de&&de.destroyPlayer()},Ce=_.debounce(()=>{ce()},1e3,{leading:!1,trailing:!0,maxWait:2e3});$(()=>{eventOn(tavern_events.APP_READY,Ce)});export{ce as createMusicPlayer,ue as destroyMusicPlayer};
//# sourceMappingURL=index.js.map