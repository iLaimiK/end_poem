import{createPinia as e,defineStore as a,storeToRefs as t}from'https://testingcf.jsdelivr.net/npm/pinia/+esm';var n={54:e=>{e.exports=function(e){var a=[];return a.toString=function(){return this.map(function(a){var t='',n=void 0!==a[5];return a[4]&&(t+='@supports ('.concat(a[4],') {')),a[2]&&(t+='@media '.concat(a[2],' {')),n&&(t+='@layer'.concat(a[5].length>0?' '.concat(a[5]):'',' {')),t+=e(a),n&&(t+='}'),a[2]&&(t+='}'),a[4]&&(t+='}'),t}).join('')},a.i=function(e,t,n,r,i){'string'==typeof e&&(e=[[null,e,void 0]]);var A={};if(n)for(var o=0;o<this.length;o++){var l=this[o][0];null!=l&&(A[l]=!0)}for(var s=0;s<e.length;s++){var p=[].concat(e[s]);n&&A[p[0]]||(void 0!==i&&(void 0===p[5]||(p[1]='@layer'.concat(p[5].length>0?' '.concat(p[5]):'',' {').concat(p[1],'}')),p[5]=i),t&&(p[2]?(p[1]='@media '.concat(p[2],' {').concat(p[1],'}'),p[2]=t):p[2]=t),r&&(p[4]?(p[1]='@supports ('.concat(p[4],') {').concat(p[1],'}'),p[4]=r):p[4]=''.concat(r)),a.push(p))}},a}},142:(e,a,t)=>{var n=t(682);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,t(424).A)('f81be098',n,!1,{ssrId:!0})},177:(e,a,t)=>{var n=t(461);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,t(424).A)('f4cdb3d8',n,!1,{ssrId:!0})},196:(e,a,t)=>{t.r(a),t.d(a,{default:()=>o});var n=t(790),r=t.n(n),i=t(54),A=t.n(i)()(r());A.push([e.id,'.aplayer-control[data-v-625c8d59]{display:flex;align-items:center;gap:1px;flex-shrink:0}.aplayer-control-btn[data-v-625c8d59]{appearance:none;-webkit-appearance:none;background-color:rgba(0,0,0,0) !important;border:none;padding:0;margin:0;outline:none;width:24px;height:24px;font-size:14px;color:#666;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s ease}.aplayer-control-btn[data-v-625c8d59]:hover{color:#b7daff}.aplayer-control-btn.active[data-v-625c8d59]{color:#b7daff}.fa-play[data-v-625c8d59]{width:8.75px}','',{version:3,sources:['webpack://./src/Aplayer_imitation/components/PlayerControls.vue'],names:[],mappings:'AACA,kCACE,YAAA,CACA,kBAAA,CACA,OAAA,CACA,aAAA,CAGF,sCACE,eAAA,CACA,uBAAA,CACA,yCAAA,CACA,WAAA,CACA,SAAA,CACA,QAAA,CACA,YAAA,CACA,UAAA,CACA,WAAA,CACA,cAAA,CACA,UAAA,CACA,cAAA,CACA,YAAA,CACA,kBAAA,CACA,sBAAA,CAEA,uBAAA,CAEA,4CACE,aAAA,CAGF,6CACE,aAAA,CAIJ,0BACE,YAAA',sourcesContent:['\n.aplayer-control {\n  display: flex;\n  align-items: center;\n  gap: 1px;\n  flex-shrink: 0;\n}\n\n.aplayer-control-btn {\n  appearance: none;\n  -webkit-appearance: none;\n  background-color: transparent !important;\n  border: none;\n  padding: 0;\n  margin: 0;\n  outline: none;\n  width: 24px;\n  height: 24px;\n  font-size: 14px;\n  color: #666;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  transition: all 0.2s ease;\n\n  &:hover {\n    color: #b7daff;\n  }\n\n  &.active {\n    color: #b7daff;\n  }\n}\n\n.fa-play {\n  width: 8.75px;\n}\n'],sourceRoot:''}]);const o=A},260:(e,a,t)=>{var n=t(392);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,t(424).A)('726aca44',n,!1,{ssrId:!0})},392:(e,a,t)=>{t.r(a),t.d(a,{default:()=>o});var n=t(790),r=t.n(n),i=t(54),A=t.n(i)()(r());A.push([e.id,'.aplayer-list[data-v-a2dd2a0e]{position:absolute;bottom:100%;left:0;right:0;background:#fff;box-shadow:0 -2px 8px rgba(0,0,0,.1);max-height:0;overflow-y:auto;transition:max-height .5s ease;margin-right:18px}.aplayer-list.aplayer-list-show[data-v-a2dd2a0e]{max-height:300px}.aplayer-list .aplayer-list-ol[data-v-a2dd2a0e]{list-style-type:none;margin:0;padding:0}.aplayer-list .aplayer-list-light[data-v-a2dd2a0e]{position:relative;height:32px;line-height:32px;padding:0 10px;font-size:15px;border-top:1px solid #e9e9e9;cursor:pointer;transition:all .3s ease;overflow:hidden;margin:0;display:flex;align-items:center}.aplayer-list .aplayer-list-light[data-v-a2dd2a0e]:first-child{border-top:none}.aplayer-list .aplayer-list-light[data-v-a2dd2a0e]:hover{background:#efefef}.aplayer-list .aplayer-list-light.aplayer-list-cur[data-v-a2dd2a0e]{background:#e6f3ff !important;border-left:4px solid #258bc9}.aplayer-list .aplayer-list-index[data-v-a2dd2a0e]{color:#666;margin-right:12px;cursor:pointer;width:15px;font-size:14px}.aplayer-list .aplayer-list-title[data-v-a2dd2a0e]{color:#666;flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;margin-right:10px;font-size:12px}.aplayer-list .aplayer-list-author[data-v-a2dd2a0e]{color:#ccc;font-size:12px}.aplayer-list[data-v-a2dd2a0e]::-webkit-scrollbar{width:5px}.aplayer-list[data-v-a2dd2a0e]::-webkit-scrollbar-track{background:#f1f1f1}.aplayer-list[data-v-a2dd2a0e]::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:4px}.aplayer-list[data-v-a2dd2a0e]::-webkit-scrollbar-thumb:hover{background:#a8a8a8}@media screen and (max-width:768px){.aplayer-list[data-v-a2dd2a0e]{top:100%;bottom:auto;box-shadow:0 2px 8px rgba(0,0,0,.1)}}','',{version:3,sources:['webpack://./src/Aplayer_imitation/components/PlayList.vue'],names:[],mappings:'AACA,+BACE,iBAAA,CACA,WAAA,CACA,MAAA,CACA,OAAA,CACA,eAAA,CACA,oCAAA,CACA,YAAA,CACA,eAAA,CACA,8BAAA,CACA,iBAAA,CAEA,iDACE,gBAAA,CAGF,gDACE,oBAAA,CACA,QAAA,CACA,SAAA,CAGF,mDACE,iBAAA,CACA,WAAA,CACA,gBAAA,CACA,cAAA,CACA,cAAA,CACA,4BAAA,CACA,cAAA,CACA,uBAAA,CACA,eAAA,CACA,QAAA,CACA,YAAA,CACA,kBAAA,CAEA,+DACE,eAAA,CAGF,yDACE,kBAAA,CAGF,oEACE,6BAAA,CACA,6BAAA,CAIJ,mDACE,UAAA,CACA,iBAAA,CACA,cAAA,CACA,UAAA,CACA,cAAA,CAGF,mDACE,UAAA,CACA,MAAA,CACA,eAAA,CACA,sBAAA,CACA,kBAAA,CACA,iBAAA,CACA,cAAA,CAGF,oDACE,UAAA,CACA,cAAA,CAGF,kDACE,SAAA,CAGF,wDACE,kBAAA,CAGF,wDACE,kBAAA,CACA,iBAAA,CAEA,8DACE,kBAAA,CAKN,oCACE,+BACE,QAAA,CACA,WAAA,CACA,mCAAA,CAAA',sourcesContent:['\n.aplayer-list {\n  position: absolute;\n  bottom: 100%;\n  left: 0;\n  right: 0;\n  background: #fff;\n  box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.1);\n  max-height: 0;\n  overflow-y: auto;\n  transition: max-height 0.5s ease;\n  margin-right: 18px;\n\n  &.aplayer-list-show {\n    max-height: 300px;\n  }\n\n  .aplayer-list-ol {\n    list-style-type: none;\n    margin: 0;\n    padding: 0;\n  }\n\n  .aplayer-list-light {\n    position: relative;\n    height: 32px;\n    line-height: 32px;\n    padding: 0 10px;\n    font-size: 15px;\n    border-top: 1px solid #e9e9e9;\n    cursor: pointer;\n    transition: all 0.3s ease;\n    overflow: hidden;\n    margin: 0;\n    display: flex;\n    align-items: center;\n\n    &:first-child {\n      border-top: none;\n    }\n\n    &:hover {\n      background: #efefef;\n    }\n\n    &.aplayer-list-cur {\n      background: #e6f3ff !important;\n      border-left: 4px solid #258bc9;\n    }\n  }\n\n  .aplayer-list-index {\n    color: #666;\n    margin-right: 12px;\n    cursor: pointer;\n    width: 15px;\n    font-size: 14px;\n  }\n\n  .aplayer-list-title {\n    color: #666;\n    flex: 1;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    margin-right: 10px;\n    font-size: 12px;\n  }\n\n  .aplayer-list-author {\n    color: #ccc;\n    font-size: 12px;\n  }\n\n  &::-webkit-scrollbar {\n    width: 5px;\n  }\n\n  &::-webkit-scrollbar-track {\n    background: #f1f1f1;\n  }\n\n  &::-webkit-scrollbar-thumb {\n    background: #c1c1c1;\n    border-radius: 4px;\n\n    &:hover {\n      background: #a8a8a8;\n    }\n  }\n}\n\n@media screen and (max-width: 768px) {\n  .aplayer-list {\n    top: 100%;\n    bottom: auto;\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n  }\n}\n'],sourceRoot:''}]);const o=A},424:(e,a,t)=>{function n(e,a){for(var t=[],n={},r=0;r<a.length;r++){var i=a[r],A=i[0],o={id:e+':'+r,css:i[1],media:i[2],sourceMap:i[3]};n[A]?n[A].parts.push(o):t.push(n[A]={id:A,parts:[o]})}return t}t.d(a,{A:()=>C});var r='undefined'!=typeof document;if('undefined'!=typeof DEBUG&&DEBUG&&!r)throw new Error('vue-style-loader cannot be used in a non-browser environment. Use { target: \'node\' } in your Webpack config to indicate a server-rendering environment.');var i={},A=r&&(document.head||document.getElementsByTagName('head')[0]),o=null,l=0,s=!1,p=function(){},d=null,c='data-vue-ssr-id',u='undefined'!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function C(e,a,t,r){s=t,d=r||{};var A=n(e,a);return m(A),function(a){for(var t=[],r=0;r<A.length;r++){var o=A[r];(l=i[o.id]).refs--,t.push(l)}a?m(A=n(e,a)):A=[];for(r=0;r<t.length;r++){var l;if(0===(l=t[r]).refs){for(var s=0;s<l.parts.length;s++)l.parts[s]();delete i[l.id]}}}}function m(e){for(var a=0;a<e.length;a++){var t=e[a],n=i[t.id];if(n){n.refs++;for(var r=0;r<n.parts.length;r++)n.parts[r](t.parts[r]);for(;r<t.parts.length;r++)n.parts.push(y(t.parts[r]));n.parts.length>t.parts.length&&(n.parts.length=t.parts.length)}else{var A=[];for(r=0;r<t.parts.length;r++)A.push(y(t.parts[r]));i[t.id]={id:t.id,refs:1,parts:A}}}}function h(){var e=document.createElement('style');return e.type='text/css',A.appendChild(e),e}function y(e){var a,t,n=document.querySelector('style['+c+'~="'+e.id+'"]');if(n){if(s)return p;n.parentNode.removeChild(n)}if(u){var r=l++;n=o||(o=h()),a=f.bind(null,n,r,!1),t=f.bind(null,n,r,!0)}else n=h(),a=x.bind(null,n),t=function(){n.parentNode.removeChild(n)};return a(e),function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap)return;a(e=n)}else t()}}var g,v=(g=[],function(e,a){return g[e]=a,g.filter(Boolean).join('\n')});function f(e,a,t,n){var r=t?'':n.css;if(e.styleSheet)e.styleSheet.cssText=v(a,r);else{var i=document.createTextNode(r),A=e.childNodes;A[a]&&e.removeChild(A[a]),A.length?e.insertBefore(i,A[a]):e.appendChild(i)}}function x(e,a){var t=a.css,n=a.media,r=a.sourceMap;if(n&&e.setAttribute('media',n),d.ssrId&&e.setAttribute(c,a.id),r&&(t+='\n/*# sourceURL='+r.sources[0]+' */',t+='\n/*# sourceMappingURL=data:application/json;base64,'+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+' */'),e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},436:(e,a,t)=>{var n=t(848);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,t(424).A)('c8eaeb2c',n,!1,{ssrId:!0})},461:(e,a,t)=>{t.r(a),t.d(a,{default:()=>o});var n=t(790),r=t.n(n),i=t(54),A=t.n(i)()(r());A.push([e.id,'.aplayer-volume-wrap[data-v-6d01fe2c]{position:relative;display:inline-block;margin-right:7px}.aplayer-volume-button[data-v-6d01fe2c]{background:none;border:none;outline:none;cursor:pointer;color:#999;font-size:11px;padding:0;transition:all .2s ease;width:15px;height:15px;display:flex;align-items:center;justify-content:center}.aplayer-volume-button[data-v-6d01fe2c]:hover{color:#b7daff}.aplayer-volume-bar-wrap[data-v-6d01fe2c]{position:absolute;bottom:15px;right:-3px;width:25px;height:36px;z-index:99;opacity:0;visibility:hidden;transition:all .3s ease-in-out}.aplayer-volume-wrap:hover .aplayer-volume-bar-wrap[data-v-6d01fe2c]{opacity:1;visibility:visible}.aplayer-volume-bar[data-v-6d01fe2c]{position:relative;width:5px;height:100%;background:#aaa;cursor:pointer;margin:0 auto;overflow:hidden;border-radius:2px;-webkit-user-select:none;user-select:none;touch-action:none;-webkit-user-drag:none;-webkit-touch-callout:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}.aplayer-volume[data-v-6d01fe2c]{position:absolute;bottom:0;right:0;width:5px;transition:all .3s ease;background:#b7daff;height:70%}@media screen and (max-width:768px){.aplayer-volume-wrap[data-v-6d01fe2c]{display:none !important}}','',{version:3,sources:['webpack://./src/Aplayer_imitation/components/VolumeControl.vue'],names:[],mappings:'AACA,sCACE,iBAAA,CACA,oBAAA,CACA,gBAAA,CAGF,wCACE,eAAA,CACA,WAAA,CACA,YAAA,CACA,cAAA,CACA,UAAA,CACA,cAAA,CACA,SAAA,CACA,uBAAA,CACA,UAAA,CACA,WAAA,CACA,YAAA,CACA,kBAAA,CACA,sBAAA,CAEA,8CACE,aAAA,CAIJ,0CACE,iBAAA,CACA,WAAA,CACA,UAAA,CACA,UAAA,CACA,WAAA,CACA,UAAA,CACA,SAAA,CACA,iBAAA,CACA,8BAAA,CAGF,qEACE,SAAA,CACA,kBAAA,CAGF,qCACE,iBAAA,CACA,SAAA,CACA,WAAA,CACA,eAAA,CACA,cAAA,CACA,aAAA,CACA,eAAA,CACA,iBAAA,CACA,wBAAA,CAAA,gBAAA,CACA,iBAAA,CACA,sBAAA,CACA,0BAAA,CACA,yCAAA,CAGF,iCACE,iBAAA,CACA,QAAA,CACA,OAAA,CACA,SAAA,CACA,uBAAA,CACA,kBAAA,CACA,UAAA,CAIF,oCACE,sCACE,uBAAA,CAAA',sourcesContent:['\n.aplayer-volume-wrap {\n  position: relative;\n  display: inline-block;\n  margin-right: 7px;\n}\n\n.aplayer-volume-button {\n  background: none;\n  border: none;\n  outline: none;\n  cursor: pointer;\n  color: #999;\n  font-size: 11px;\n  padding: 0;\n  transition: all 0.2s ease;\n  width: 15px;\n  height: 15px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  &:hover {\n    color: #b7daff;\n  }\n}\n\n.aplayer-volume-bar-wrap {\n  position: absolute;\n  bottom: 15px;\n  right: -3px;\n  width: 25px;\n  height: 36px;\n  z-index: 99;\n  opacity: 0;\n  visibility: hidden;\n  transition: all 0.3s ease-in-out;\n}\n\n.aplayer-volume-wrap:hover .aplayer-volume-bar-wrap {\n  opacity: 1;\n  visibility: visible;\n}\n\n.aplayer-volume-bar {\n  position: relative;\n  width: 5px;\n  height: 100%;\n  background: #aaa;\n  cursor: pointer;\n  margin: 0 auto;\n  overflow: hidden;\n  border-radius: 2px;\n  user-select: none; // 防止拖动时选中文本\n  touch-action: none;\n  -webkit-user-drag: none;\n  -webkit-touch-callout: none;\n  -webkit-tap-highlight-color: transparent;\n}\n\n.aplayer-volume {\n  position: absolute;\n  bottom: 0;\n  right: 0;\n  width: 5px;\n  transition: all 0.3s ease;\n  background: #b7daff;\n  height: 70%;\n}\n\n// 移动端隐藏音量控制\n@media screen and (max-width: 768px) {\n  .aplayer-volume-wrap {\n    display: none !important;\n  }\n}\n'],sourceRoot:''}]);const o=A},682:(e,a,t)=>{t.r(a),t.d(a,{default:()=>o});var n=t(790),r=t.n(n),i=t(54),A=t.n(i)()(r());A.push([e.id,'.aplayer-bar-wrap[data-v-b5bb32c0]{flex:1;margin-right:7px;padding:4px 0;cursor:pointer}.aplayer-bar[data-v-b5bb32c0]{position:relative;height:2px;width:100%;background:#cdcdcd;cursor:pointer;border-radius:1px}.aplayer-loaded[data-v-b5bb32c0]{position:absolute;left:0;top:0;bottom:0;background:#aaa;height:2px;transition:all .5s ease;width:0;border-radius:1px}.aplayer-played[data-v-b5bb32c0]{position:absolute;left:0;top:0;bottom:0;height:2px;width:0;border-radius:1px;background:#b7daff;transition:all .1s ease}.aplayer-thumb[data-v-b5bb32c0]{position:absolute;top:50%;right:-4px;margin-top:-4px;height:8px;width:8px;border-radius:50%;cursor:pointer;transition:all .3s ease;transform:scale(0);opacity:0;background:#b7daff}.aplayer-bar-wrap:hover .aplayer-thumb[data-v-b5bb32c0]{transform:scale(1);opacity:1}','',{version:3,sources:['webpack://./src/Aplayer_imitation/components/ProgressBar.vue'],names:[],mappings:'AACA,mCACE,MAAA,CACA,gBAAA,CACA,aAAA,CACA,cAAA,CAGF,8BACE,iBAAA,CACA,UAAA,CACA,UAAA,CACA,kBAAA,CACA,cAAA,CACA,iBAAA,CAGF,iCACE,iBAAA,CACA,MAAA,CACA,KAAA,CACA,QAAA,CACA,eAAA,CACA,UAAA,CACA,uBAAA,CACA,OAAA,CACA,iBAAA,CAGF,iCACE,iBAAA,CACA,MAAA,CACA,KAAA,CACA,QAAA,CACA,UAAA,CACA,OAAA,CACA,iBAAA,CACA,kBAAA,CACA,uBAAA,CAGF,gCACE,iBAAA,CACA,OAAA,CACA,UAAA,CACA,eAAA,CACA,UAAA,CACA,SAAA,CACA,iBAAA,CACA,cAAA,CACA,uBAAA,CACA,kBAAA,CACA,SAAA,CACA,kBAAA,CAGF,wDACE,kBAAA,CACA,SAAA',sourcesContent:['\n.aplayer-bar-wrap {\n  flex: 1;\n  margin-right: 7px;\n  padding: 4px 0;\n  cursor: pointer;\n}\n\n.aplayer-bar {\n  position: relative;\n  height: 2px;\n  width: 100%;\n  background: #cdcdcd;\n  cursor: pointer;\n  border-radius: 1px;\n}\n\n.aplayer-loaded {\n  position: absolute;\n  left: 0;\n  top: 0;\n  bottom: 0;\n  background: #aaa;\n  height: 2px;\n  transition: all 0.5s ease;\n  width: 0;\n  border-radius: 1px;\n}\n\n.aplayer-played {\n  position: absolute;\n  left: 0;\n  top: 0;\n  bottom: 0;\n  height: 2px;\n  width: 0;\n  border-radius: 1px;\n  background: #b7daff;\n  transition: all 0.1s ease;\n}\n\n.aplayer-thumb {\n  position: absolute;\n  top: 50%;\n  right: -4px;\n  margin-top: -4px;\n  height: 8px;\n  width: 8px;\n  border-radius: 50%;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  transform: scale(0);\n  opacity: 0;\n  background: #b7daff;\n}\n\n.aplayer-bar-wrap:hover .aplayer-thumb {\n  transform: scale(1);\n  opacity: 1;\n}\n'],sourceRoot:''}]);const o=A},790:e=>{e.exports=function(e){var a=e[1],t=e[3];if(!t)return a;if('function'==typeof btoa){var n=btoa(unescape(encodeURIComponent(JSON.stringify(t)))),r='sourceMappingURL=data:application/json;charset=utf-8;base64,'.concat(n),i='/*# '.concat(r,' */');return[a].concat([i]).join('\n')}return[a].join('\n')}},848:(e,a,t)=>{t.r(a),t.d(a,{default:()=>o});var n=t(790),r=t.n(n),i=t(54),A=t.n(i)()(r());A.push([e.id,'.aplayer[data-v-1409529e]{position:absolute;left:0;bottom:0;z-index:9999;background:#fff;border-radius:0;box-shadow:0 2px 2px 0 rgba(0,0,0,.14),0 3px 1px -2px rgba(0,0,0,.2),0 1px 5px 0 rgba(0,0,0,.12);font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;font-size:12px;line-height:normal;max-width:400px;min-width:300px;transition:all .3s ease}.aplayer.aplayer-narrow[data-v-1409529e]{width:18px;min-width:18px;transform:translateX(-20%)}.aplayer.aplayer-narrow .aplayer-info[data-v-1409529e]{display:none}.aplayer.aplayer-narrow .aplayer-miniswitcher .aplayer-icon[data-v-1409529e]{transform:rotate(0)}.aplayer-body[data-v-1409529e]{display:flex;position:relative;overflow:hidden;height:66px;padding-right:18px}.aplayer-pic[data-v-1409529e]{position:relative;width:66px;height:66px;background-size:cover;background-position:center;transition:all .3s ease;cursor:pointer;flex-shrink:0;overflow:hidden}.aplayer-pic .aplayer-pic-img[data-v-1409529e]{width:100%;height:100%;object-fit:cover;display:block}.aplayer-pic .aplayer-button[data-v-1409529e]{position:absolute;display:flex;align-items:center;justify-content:center;outline:none;cursor:pointer;color:#fff;border-radius:50%;border:2px solid hsla(0,0%,100%,.8);top:50%;left:50%;transform:translate(-50%,-50%);width:30px;height:30px;background:rgba(0,0,0,.2);font-size:16px;transition:all .1s ease-out}.aplayer-pic .aplayer-button[data-v-1409529e]:hover{border-color:#fff}.aplayer-pic .aplayer-button.aplayer-button-playing[data-v-1409529e]{top:auto;left:auto;bottom:6px;right:6px;transform:none;width:20px;height:20px;background:rgba(0,0,0,0);font-size:10px}.aplayer-pic .aplayer-button .fa-play[data-v-1409529e]{text-align:center;height:15px;width:8px;font-size:14px}.aplayer-pic .aplayer-button .fa-pause[data-v-1409529e]{text-align:center;height:10px;width:12px}.aplayer-info[data-v-1409529e]{flex:1;display:flex;flex-direction:column;min-width:0;padding:8px 15px 10px 15px;justify-content:space-between;border-top:1px solid #e9e9e9}.aplayer-info-top[data-v-1409529e]{display:flex;align-items:center;flex-wrap:nowrap}.aplayer-music[data-v-1409529e]{flex:1;overflow:hidden;margin-right:15px;min-width:0}.aplayer-music .aplayer-title[data-v-1409529e]{font-size:14px;font-weight:400;color:#212121;margin:0 0 2px 0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;line-height:1.1}.aplayer-music .aplayer-author[data-v-1409529e]{font-size:12px;color:#666;margin:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;line-height:1.1}.aplayer-controller[data-v-1409529e]{display:flex;align-items:center;width:100%}.aplayer-time[data-v-1409529e]{display:flex;align-items:center;color:#999;font-size:11px;flex-shrink:0;white-space:nowrap}.aplayer-time .aplayer-time-inner[data-v-1409529e]{margin-right:7px;font-variant-numeric:tabular-nums}.aplayer-time .aplayer-ptime[data-v-1409529e],.aplayer-time .aplayer-dtime[data-v-1409529e]{font-variant-numeric:tabular-nums}.aplayer-order[data-v-1409529e]{background:none;border:none;outline:none;cursor:pointer;color:#999;font-size:11px;padding:0;transition:all .2s ease;width:15px;height:15px;display:flex;align-items:center;justify-content:center;margin:0 1px}.aplayer-order[data-v-1409529e]:hover{color:#b7daff}.aplayer-miniswitcher[data-v-1409529e]{position:absolute;top:0;right:0;bottom:0;height:100%;background:#e6e6e6;width:18px;border-radius:0 2px 2px 0}.aplayer-miniswitcher .aplayer-icon[data-v-1409529e]{height:100%;width:100%;transform:rotate(180deg);transition:all .3s ease;border:none;background-color:rgba(0,0,0,0);outline:none;cursor:pointer;opacity:.8;vertical-align:middle;padding:0;font-size:12px;margin:0;display:inline-block}.aplayer-miniswitcher .aplayer-icon svg[data-v-1409529e]{width:12px;height:12px;fill:#666}@media screen and (max-width:1024px){.aplayer[data-v-1409529e]{max-width:calc(100vw - 40px)}}@media screen and (max-width:768px){.aplayer[data-v-1409529e]{bottom:80% !important;max-width:calc(100vw - 20px);min-width:auto}.aplayer.aplayer-narrow[data-v-1409529e]{bottom:80% !important}}@media screen and (max-width:640px){.aplayer-body[data-v-1409529e]{height:58px}.aplayer-pic[data-v-1409529e]{width:58px;height:58px}.aplayer-info[data-v-1409529e]{padding:7px 12px 9px 12px}}@media screen and (max-width:480px){.aplayer-body[data-v-1409529e]{height:54px}.aplayer-pic .aplayer-author[data-v-1409529e]{font-size:11px}.aplayer-time .aplayer-time-inner[data-v-1409529e]{margin-right:5px}.aplayer-order[data-v-1409529e]{width:13px;height:13px;font-size:10px}}@media screen and (max-width:390px){.aplayer-body[data-v-1409529e]{height:50px}.aplayer-pic[data-v-1409529e]{width:50px;height:50px}.aplayer-info[data-v-1409529e]{padding:4px 10px 6px 10px}.aplayer-music .aplayer-title[data-v-1409529e]{font-size:12px}.aplayer-music .aplayer-author[data-v-1409529e]{font-size:10px}}@media screen and (max-width:320px){.aplayer-body[data-v-1409529e]{height:46px}.aplayer-pic[data-v-1409529e]{width:46px;height:46px}.aplayer-info[data-v-1409529e]{padding:3px 8px 5px 8px}.aplayer-order[data-v-1409529e]{display:none}}','',{version:3,sources:['webpack://./src/Aplayer_imitation/components/MusicPlayer.vue'],names:[],mappings:'AACA,0BACE,iBAAA,CACA,MAAA,CACA,QAAA,CACA,YAAA,CACA,eAAA,CACA,eAAA,CACA,gGACE,CAGF,+EAAA,CACA,cAAA,CACA,kBAAA,CACA,eAAA,CACA,eAAA,CACA,uBAAA,CAEA,yCACE,UAAA,CACA,cAAA,CACA,0BAAA,CAEA,uDACE,YAAA,CAIA,6EACE,mBAAA,CAMR,+BACE,YAAA,CACA,iBAAA,CACA,eAAA,CACA,WAAA,CACA,kBAAA,CAGF,8BACE,iBAAA,CACA,UAAA,CACA,WAAA,CACA,qBAAA,CACA,0BAAA,CACA,uBAAA,CACA,cAAA,CACA,aAAA,CACA,eAAA,CAEA,+CACE,UAAA,CACA,WAAA,CACA,gBAAA,CACA,aAAA,CAGF,8CACE,iBAAA,CACA,YAAA,CACA,kBAAA,CACA,sBAAA,CACA,YAAA,CACA,cAAA,CACA,UAAA,CACA,iBAAA,CACA,mCAAA,CAEA,OAAA,CACA,QAAA,CACA,8BAAA,CACA,UAAA,CACA,WAAA,CACA,yBAAA,CACA,cAAA,CACA,2BAAA,CAEA,oDACE,iBAAA,CAGF,qEACE,QAAA,CACA,SAAA,CACA,UAAA,CACA,SAAA,CACA,cAAA,CACA,UAAA,CACA,WAAA,CACA,wBAAA,CACA,cAAA,CAGF,uDACE,iBAAA,CACA,WAAA,CACA,SAAA,CACA,cAAA,CAGF,wDACE,iBAAA,CACA,WAAA,CACA,UAAA,CAKN,+BACE,MAAA,CACA,YAAA,CACA,qBAAA,CACA,WAAA,CACA,0BAAA,CACA,6BAAA,CACA,4BAAA,CAGF,mCACE,YAAA,CACA,kBAAA,CACA,gBAAA,CAGF,gCACE,MAAA,CACA,eAAA,CACA,iBAAA,CACA,WAAA,CAEA,+CACE,cAAA,CACA,eAAA,CACA,aAAA,CACA,gBAAA,CACA,eAAA,CACA,sBAAA,CACA,kBAAA,CACA,eAAA,CAGF,gDACE,cAAA,CACA,UAAA,CACA,QAAA,CACA,eAAA,CACA,sBAAA,CACA,kBAAA,CACA,eAAA,CAIJ,qCACE,YAAA,CACA,kBAAA,CACA,UAAA,CAGF,+BACE,YAAA,CACA,kBAAA,CACA,UAAA,CACA,cAAA,CACA,aAAA,CACA,kBAAA,CAEA,mDACE,gBAAA,CACA,iCAAA,CAGF,4FAEE,iCAAA,CAIJ,gCACE,eAAA,CACA,WAAA,CACA,YAAA,CACA,cAAA,CACA,UAAA,CACA,cAAA,CACA,SAAA,CACA,uBAAA,CACA,UAAA,CACA,WAAA,CACA,YAAA,CACA,kBAAA,CACA,sBAAA,CACA,YAAA,CAEA,sCACE,aAAA,CAIJ,uCACE,iBAAA,CACA,KAAA,CACA,OAAA,CACA,QAAA,CACA,WAAA,CACA,kBAAA,CACA,UAAA,CACA,yBAAA,CAEA,qDACE,WAAA,CACA,UAAA,CACA,wBAAA,CACA,uBAAA,CACA,WAAA,CACA,8BAAA,CACA,YAAA,CACA,cAAA,CACA,UAAA,CACA,qBAAA,CACA,SAAA,CACA,cAAA,CACA,QAAA,CACA,oBAAA,CAEA,yDACE,UAAA,CACA,WAAA,CACA,SAAA,CAMN,qCACE,0BACE,4BAAA,CAAA,CAIJ,oCACE,0BACE,qBAAA,CACA,4BAAA,CACA,cAAA,CAEA,yCACE,qBAAA,CAAA,CAMN,oCACE,+BACE,WAAA,CAGF,8BACE,UAAA,CACA,WAAA,CAGF,+BACE,yBAAA,CAAA,CAKJ,oCACE,+BACE,WAAA,CAIA,8CACE,cAAA,CAKF,mDACE,gBAAA,CAIJ,gCACE,UAAA,CACA,WAAA,CACA,cAAA,CAAA,CAKJ,oCACE,+BACE,WAAA,CAGF,8BACE,UAAA,CACA,WAAA,CAGF,+BACE,yBAAA,CAIA,+CACE,cAAA,CAGF,gDACE,cAAA,CAAA,CAMN,oCACE,+BACE,WAAA,CAGF,8BACE,UAAA,CACA,WAAA,CAGF,+BACE,uBAAA,CAGF,gCACE,YAAA,CAAA',sourcesContent:['\n.aplayer {\n  position: absolute;\n  left: 0;\n  bottom: 0;\n  z-index: 9999;\n  background: #fff;\n  border-radius: 0;\n  box-shadow:\n    0 2px 2px 0 rgba(0, 0, 0, 0.14),\n    0 3px 1px -2px rgba(0, 0, 0, 0.2),\n    0 1px 5px 0 rgba(0, 0, 0, 0.12);\n  font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Roboto, Arial, sans-serif;\n  font-size: 12px;\n  line-height: normal;\n  max-width: 400px;\n  min-width: 300px;\n  transition: all 0.3s ease;\n\n  &.aplayer-narrow {\n    width: 18px;\n    min-width: 18px;\n    transform: translateX(-20%);\n\n    .aplayer-info {\n      display: none;\n    }\n\n    .aplayer-miniswitcher {\n      .aplayer-icon {\n        transform: rotate(0);\n      }\n    }\n  }\n}\n\n.aplayer-body {\n  display: flex;\n  position: relative;\n  overflow: hidden;\n  height: 66px;\n  padding-right: 18px;\n}\n\n.aplayer-pic {\n  position: relative;\n  width: 66px;\n  height: 66px;\n  background-size: cover;\n  background-position: center;\n  transition: all 0.3s ease;\n  cursor: pointer;\n  flex-shrink: 0;\n  overflow: hidden;\n\n  .aplayer-pic-img {\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n    display: block;\n  }\n\n  .aplayer-button {\n    position: absolute;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    outline: none;\n    cursor: pointer;\n    color: #fff;\n    border-radius: 50%;\n    border: 2px solid rgba(255, 255, 255, 0.8);\n\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    width: 30px;\n    height: 30px;\n    background: rgba(0, 0, 0, 0.2);\n    font-size: 16px;\n    transition: all 0.1s ease-out;\n\n    &:hover {\n      border-color: rgba(255, 255, 255, 1);\n    }\n\n    &.aplayer-button-playing {\n      top: auto;\n      left: auto;\n      bottom: 6px;\n      right: 6px;\n      transform: none;\n      width: 20px;\n      height: 20px;\n      background: transparent;\n      font-size: 10px;\n    }\n\n    .fa-play {\n      text-align: center;\n      height: 15px;\n      width: 8px;\n      font-size: 14px;\n    }\n\n    .fa-pause {\n      text-align: center;\n      height: 10px;\n      width: 12px;\n    }\n  }\n}\n\n.aplayer-info {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  min-width: 0;\n  padding: 8px 15px 10px 15px;\n  justify-content: space-between;\n  border-top: 1px solid #e9e9e9;\n}\n\n.aplayer-info-top {\n  display: flex;\n  align-items: center;\n  flex-wrap: nowrap;\n}\n\n.aplayer-music {\n  flex: 1;\n  overflow: hidden;\n  margin-right: 15px;\n  min-width: 0;\n\n  .aplayer-title {\n    font-size: 14px;\n    font-weight: 400;\n    color: #212121;\n    margin: 0 0 2px 0;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    line-height: 1.1;\n  }\n\n  .aplayer-author {\n    font-size: 12px;\n    color: #666;\n    margin: 0;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    line-height: 1.1;\n  }\n}\n\n.aplayer-controller {\n  display: flex;\n  align-items: center;\n  width: 100%;\n}\n\n.aplayer-time {\n  display: flex;\n  align-items: center;\n  color: #999;\n  font-size: 11px;\n  flex-shrink: 0;\n  white-space: nowrap;\n\n  .aplayer-time-inner {\n    margin-right: 7px;\n    font-variant-numeric: tabular-nums;\n  }\n\n  .aplayer-ptime,\n  .aplayer-dtime {\n    font-variant-numeric: tabular-nums;\n  }\n}\n\n.aplayer-order {\n  background: none;\n  border: none;\n  outline: none;\n  cursor: pointer;\n  color: #999;\n  font-size: 11px;\n  padding: 0;\n  transition: all 0.2s ease;\n  width: 15px;\n  height: 15px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin: 0 1px;\n\n  &:hover {\n    color: #b7daff;\n  }\n}\n\n.aplayer-miniswitcher {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  height: 100%;\n  background: #e6e6e6;\n  width: 18px;\n  border-radius: 0 2px 2px 0;\n\n  .aplayer-icon {\n    height: 100%;\n    width: 100%;\n    transform: rotate(180deg);\n    transition: all 0.3s ease;\n    border: none;\n    background-color: transparent;\n    outline: none;\n    cursor: pointer;\n    opacity: 0.8;\n    vertical-align: middle;\n    padding: 0;\n    font-size: 12px;\n    margin: 0;\n    display: inline-block;\n\n    svg {\n      width: 12px;\n      height: 12px;\n      fill: #666;\n    }\n  }\n}\n\n// 移动端适配 - 标准响应式断点\n@media screen and (max-width: 1024px) {\n  .aplayer {\n    max-width: calc(100vw - 40px);\n  }\n}\n\n@media screen and (max-width: 768px) {\n  .aplayer {\n    bottom: 80% !important;\n    max-width: calc(100vw - 20px);\n    min-width: auto;\n\n    &.aplayer-narrow {\n      bottom: 80% !important;\n    }\n  }\n}\n\n// 平板端调整\n@media screen and (max-width: 640px) {\n  .aplayer-body {\n    height: 58px;\n  }\n\n  .aplayer-pic {\n    width: 58px;\n    height: 58px;\n  }\n\n  .aplayer-info {\n    padding: 7px 12px 9px 12px;\n  }\n}\n\n// 移动端\n@media screen and (max-width: 480px) {\n  .aplayer-body {\n    height: 54px;\n  }\n\n  .aplayer-pic {\n    .aplayer-author {\n      font-size: 11px;\n    }\n  }\n\n  .aplayer-time {\n    .aplayer-time-inner {\n      margin-right: 5px;\n    }\n  }\n\n  .aplayer-order {\n    width: 13px;\n    height: 13px;\n    font-size: 10px;\n  }\n}\n\n// 小屏移动端\n@media screen and (max-width: 390px) {\n  .aplayer-body {\n    height: 50px;\n  }\n\n  .aplayer-pic {\n    width: 50px;\n    height: 50px;\n  }\n\n  .aplayer-info {\n    padding: 4px 10px 6px 10px;\n  }\n\n  .aplayer-music {\n    .aplayer-title {\n      font-size: 12px;\n    }\n\n    .aplayer-author {\n      font-size: 10px;\n    }\n  }\n}\n\n// 极小屏幕\n@media screen and (max-width: 320px) {\n  .aplayer-body {\n    height: 46px;\n  }\n\n  .aplayer-pic {\n    width: 46px;\n    height: 46px;\n  }\n\n  .aplayer-info {\n    padding: 3px 8px 5px 8px;\n  }\n\n  .aplayer-order {\n    display: none;\n  }\n}\n'],sourceRoot:''}]);const o=A},895:(e,a)=>{a.A=(e,a)=>{const t=e.__vccOpts||e;for(const[e,n]of a)t[e]=n;return t}},944:(e,a,t)=>{var n=t(196);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,t(424).A)('9a37297a',n,!1,{ssrId:!0})}},r={};function i(e){var a=r[e];if(void 0!==a)return a.exports;var t=r[e]={id:e,exports:{}};return n[e](t,t.exports,i),t.exports}i.n=e=>{var a=e&&e.__esModule?()=>e.default:()=>e;return i.d(a,{a}),a},i.d=(e,a)=>{for(var t in a)i.o(a,t)&&!i.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:a[t]})},i.o=(e,a)=>Object.prototype.hasOwnProperty.call(e,a),i.r=e=>{'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(e,'__esModule',{value:!0})};const A=Vue,o=_.memoize(e=>{if(!e||isNaN(e))return{minutes:'00',seconds:'00',full:'00:00'};const a=Math.floor(e/60),t=Math.floor(e%60),n=a.toString().padStart(2,'0'),r=t.toString().padStart(2,'0');return{minutes:n,seconds:r,full:`${n}:${r}`}}),l=(e,a)=>!a||isNaN(a)||e<0||isNaN(e)?0:_.clamp(e/a*100,0,100),s=(e,a)=>{if(e<=1)return 0;const t=_.range(e).filter(e=>e!==a);return _.sample(t)??0};class p{audio;eventListeners=new Map;constructor(){this.audio=new Audio,this.audio.preload='auto',this.bindAudioEvents()}bindAudioEvents(){['play','pause','ended','timeupdate','loadedmetadata','canplay','progress','error'].forEach(e=>{this.audio.addEventListener(e,a=>{this.emit(e,a)})})}on(e,a){this.eventListeners.has(e)||this.eventListeners.set(e,[]),this.eventListeners.get(e).push(a)}off(e,a){if(this.eventListeners.has(e))if(a){const t=this.eventListeners.get(e),n=t.indexOf(a);n>-1&&t.splice(n,1)}else this.eventListeners.delete(e)}emit(e,a){const t=this.eventListeners.get(e);t&&t.forEach(e=>e(a))}async loadTrack(e){return new Promise((a,t)=>{this.audio.pause(),this.audio.currentTime=0,this.audio.removeAttribute('src'),this.audio.load(),this.audio.src=e.url;const n=()=>{this.audio.removeEventListener('canplay',n),this.audio.removeEventListener('error',r),a()},r=a=>{this.audio.removeEventListener('canplay',n),this.audio.removeEventListener('error',r),t(new Error(`音频加载失败: ${e.name}`))};this.audio.addEventListener('canplay',n,{once:!0}),this.audio.addEventListener('error',r,{once:!0})})}async play(){if(!(this.audio.readyState>=2))return new Promise((e,a)=>{const t=async()=>{this.audio.removeEventListener('canplay',t);try{await this.audio.play(),e()}catch(e){a(new Error(`播放失败: ${e}`))}};this.audio.addEventListener('canplay',t,{once:!0})});try{await this.audio.play()}catch(e){throw console.error('播放失败:',e),e}}pause(){this.audio.pause()}seek(e){this.audio.currentTime=e}setVolume(e){this.audio.volume=Math.max(0,Math.min(1,e))}get currentTime(){return this.audio.currentTime||0}get duration(){return this.audio.duration||0}get buffered(){const e=this.audio.buffered;return e.length>0?e.end(e.length-1):0}get volume(){return this.audio.volume}get paused(){return this.audio.paused}get ended(){return this.audio.ended}get formattedCurrentTime(){return o(this.currentTime)}get formattedDuration(){return o(this.duration)}destroy(){this.pause(),this.audio.removeAttribute('src'),this.audio.load(),this.eventListeners.clear()}}const d=[{name:'String Theocracy',artist:'Mili',url:'https://gitgud.io/yoyo514/elegy-for-the-end/-/raw/master/music/String%20Theocracy%EF%BC%88%E7%A5%9E%E6%9D%83%E6%94%BF%E6%B2%BB%E4%B9%8B%E7%BB%B3%EF%BC%89Library%20of%20Ruina%20-%20Mili.mp3',cover:'https://p2.music.126.net/uSA7KUpo8rCGvK5z5VvXiA==/109951167104512763.jpg?param=140y140'},{name:'Sis Puella Magica Orchestra',artist:'Música Melódica',url:'https://gitgud.io/yoyo514/elegy-for-the-end/-/raw/master/music/Sis%20Puella%20Magica%20Orchestra%20-%20M%C3%BAsica%20Mel%C3%B3dica.mp3',cover:'https://p2.music.126.net/BRkOispUjB7V_lxC990G7A==/109951166086738670.jpg?param=140y140'},{name:'业火的红莲',artist:'逆理的钢琴师',url:'https://gitgud.io/yoyo514/elegy-for-the-end/-/raw/master/music/%E4%B8%9A%E7%81%AB%E7%9A%84%E7%BA%A2%E8%8E%B2%20-%20%E9%80%86%E7%90%86%E7%9A%84%E9%92%A2%E7%90%B4%E5%B8%88.mp3',cover:'http://p2.music.126.net/LMZ6VWw5hil_odFv6MGYXQ==/109951169607637648.jpg?param=140y140'},{name:'カスカナヒカリ',artist:'藤間仁',url:'https://gitgud.io/yoyo514/elegy-for-the-end/-/raw/master/music/%E3%82%AB%E3%82%B9%E3%82%AB%E3%83%8A%E3%83%92%E3%82%AB%E3%83%AA%20-%20%E8%97%A4%E9%96%93%E4%BB%81.mp3',cover:'https://cf.mora.jp/contents/package/0000/00000284/0009/354/490/0009354490.200.jpg'},{name:'DEEP (深渊)',artist:'Pianoboy高至豪',url:'http://gitgud.io/yoyo514/elegy-for-the-end/-/raw/master/music/DEEP%20(%E6%B7%B1%E6%B8%8A)%20-%20Pianoboy%E9%AB%98%E8%87%B3%E8%B1%AA.mp3',cover:'https://p1.music.126.net/KS1iNTS-9csOTzew3kFm5w==/109951165414795064.jpg?param=200y200'},{name:'Light Above The Sky',artist:'Delos',url:'https://gitgud.io/yoyo514/elegy-for-the-end/-/raw/master/music/Light%20Above%20The%20Sky%20-%20Delos.mp3',cover:'https://p2.music.126.net/82DoOe7CoKlkrze7k4gyOQ==/109951163708382315.jpg?param=140y140'},{name:'无人之地',artist:'UM',url:'https://gitgud.io/yoyo514/elegy-for-the-end/-/raw/master/music/%E6%97%A0%E4%BA%BA%E4%B9%8B%E5%9C%B0%20-%20UM.mp3',cover:'https://p1.music.126.net/ImfmFqhrVtvSi0v7LYSKGQ==/109951169790490991.jpg?param=140y140'},{name:'逆洄',artist:'alpaca咕噜',url:'https://gitgud.io/yoyo514/elegy-for-the-end/-/raw/master/music/%E9%80%86%E6%B4%84%20-%20alpaca%E5%92%95%E5%99%9C.mp3',cover:'https://p2.music.126.net/BqJv2QRfRm4OS9j0sbWRAg==/109951170257467059.jpg?param=140y140'},{name:'化蝶轻岚境',artist:'MoFeansy沐风',url:'https://gitgud.io/yoyo514/elegy-for-the-end/-/raw/master/music/%E5%8C%96%E8%9D%B6%E8%BD%BB%E5%B2%9A%E5%A2%83%20-%20MoFeansy%E6%B2%90%E9%A3%8E.mp3',cover:'https://img1.kuwo.cn/star/albumcover/500/s4s24/97/4272800514.png'},{name:'海鸣',artist:'路灰气球',url:'https://gitgud.io/yoyo514/elegy-for-the-end/-/raw/master/music/%E6%B5%B7%E9%B8%A3%20-%20%E8%B7%AF%E7%81%B0%E6%B0%94%E7%90%83.mp3',cover:'https://p2.music.126.net/YU9RRPiWMFMXRPr-nMY4BQ==/109951168882397092.jpg?param=140y140'},{name:'活着就是一种伟大',artist:'Maple暖枫',url:'https://gitgud.io/yoyo514/elegy-for-the-end/-/raw/master/music/%E6%B4%BB%E7%9D%80%E5%B0%B1%E6%98%AF%E4%B8%80%E7%A7%8D%E4%BC%9F%E5%A4%A7%20-%20Maple%E6%9A%96%E6%9E%AB.mp3',cover:'http://p1.music.126.net/QeXscV_m8uriJ-rt6EQPZQ==/109951168939820951.jpg?param=140y140'},{name:'Lily',artist:'Binary Haze Interactive/Mili',url:'https://gitgud.io/yoyo514/elegy-for-the-end/-/raw/master/music/Lily%20-%20Binary%20Haze%20Interactive&Mili.mp3',cover:'https://p2.music.126.net/cCXt0Rbny_HPiEKLNmA6Fw==/109951166057712738.jpg?param=140y140'},{name:'North',artist:'Binary Haze Interactive/Mili',url:'https://gitgud.io/yoyo514/elegy-for-the-end/-/raw/master/music/North%20-%20Binary%20Haze%20Interactive&Mili.mp3',cover:'https://p2.music.126.net/cCXt0Rbny_HPiEKLNmA6Fw==/109951166057712738.jpg?param=140y140'},{name:'Harmonious',artist:'Binary Haze Interactive/Mili',url:'https://gitgud.io/yoyo514/elegy-for-the-end/-/raw/master/music/Harmonious%20-%20Binary%20Haze%20Interactive&Mili.mp3',cover:'https://p2.music.126.net/cCXt0Rbny_HPiEKLNmA6Fw==/109951166057712738.jpg?param=140y140'},{name:'Mother - Outro',artist:'Binary Haze Interactive/Mili',url:'https://gitgud.io/yoyo514/elegy-for-the-end/-/raw/master/music/Mother%20-%20Outro%20-%20Binary%20Haze%20Interactive&Mili.mp3',cover:'https://p2.music.126.net/cCXt0Rbny_HPiEKLNmA6Fw==/109951166057712738.jpg?param=140y140'}];var c,u,C;!function(e){e.LIST='list',e.RANDOM='random',e.REPEAT_ONE='repeat-one',e.NONE='none'}(c||(c={})),function(e){e.PLAY='play',e.PAUSE='pause',e.ENDED='ended',e.TIME_UPDATE='timeupdate',e.LOADED_METADATA='loadedmetadata',e.CAN_PLAY='canplay',e.PROGRESS='progress',e.ERROR='error'}(u||(u={})),function(e){e.UNLOADED='unloaded',e.LOADING='loading',e.LOADED='loaded',e.ERROR='error'}(C||(C={}));const m=a('player',()=>{const e=(0,A.ref)([...d]),a=(0,A.ref)(0),t=(0,A.ref)(!1),n=(0,A.ref)(.7),r=(0,A.ref)(.7),i=(0,A.ref)(c.LIST),o=(0,A.ref)(!1),l=(0,A.ref)(!0),p=(0,A.ref)(!1),u=(0,A.ref)(0),C=(0,A.ref)(0),m=(0,A.ref)(0),h=(0,A.computed)(()=>e.value[a.value]||null),y=(0,A.computed)(()=>e.value.length>1),g=(0,A.computed)(()=>e.value.length>1),v=(0,A.computed)(()=>C.value?u.value/C.value*100:0),f=(0,A.computed)(()=>C.value?m.value/C.value*100:0),x=(0,A.computed)(()=>0===n.value),b=(0,A.computed)(()=>({currentIndex:a.value,isPlaying:t.value,volume:n.value,previousVolume:r.value,order:i.value,isMinimized:o.value,listFolded:l.value,currentTime:u.value,duration:C.value,buffered:m.value})),E=t=>{t>=0&&t<e.value.length&&(a.value=t)},w=e=>{t.value=e},B=e=>{const a=Math.max(0,Math.min(1,e));n.value>0&&(r.value=n.value),n.value=a},k=e=>{u.value=e},N=e=>{C.value=e},S=e=>{m.value=e},P=()=>{switch(i.value){case c.RANDOM:return s(e.value.length,a.value);case c.REPEAT_ONE:return a.value;case c.NONE:return a.value>=e.value.length-1?a.value:a.value+1;case c.LIST:default:return(a.value+1)%e.value.length}},R=()=>{switch(i.value){case c.RANDOM:return s(e.value.length,a.value);case c.REPEAT_ONE:return a.value;case c.NONE:return a.value<=0?a.value:a.value-1;case c.LIST:default:return 0===a.value?e.value.length-1:a.value-1}};return{audioList:e,currentIndex:a,isPlaying:t,volume:n,previousVolume:r,order:i,isMinimized:o,listFolded:l,autoPlay:p,currentTime:u,duration:C,buffered:m,currentTrack:h,canSkipPrev:y,canSkipNext:g,progress:v,bufferedProgress:f,isMuted:x,playerState:b,setAudioList:t=>{e.value=[...t],a.value>=t.length&&(a.value=0)},setCurrentIndex:E,setPlaying:w,setVolume:B,toggleMute:()=>{n.value>0?B(0):B(r.value>0?r.value:1)},setOrder:e=>{i.value=e},toggleMinimized:()=>{o.value=!o.value},toggleList:()=>{l.value=!l.value},updateTime:k,updateDuration:N,updateBuffered:S,getNextIndex:P,getPrevIndex:R,skipToNext:()=>{const e=P();i.value!==c.NONE||e!==a.value?E(e):w(!1)},skipToPrev:()=>{const e=R();i.value!==c.NONE||e!==a.value?E(e):w(!1)},switchTo:e=>{E(e)},reset:()=>{w(!1),k(0),N(0),S(0)},initFromSettings:t=>{void 0!==t.defaultVolume&&(n.value=t.defaultVolume,r.value=t.defaultVolume),void 0!==t.defaultOrder&&(i.value=t.defaultOrder),void 0!==t.listFolded&&(l.value=t.listFolded),void 0!==t.isMinimized&&(o.value=t.isMinimized),void 0!==t.autoPlay&&(p.value=t.autoPlay),t.customAudioList&&Array.isArray(t.customAudioList)&&t.customAudioList.length>0&&(e.value=[...t.customAudioList],a.value>=t.customAudioList.length&&(a.value=0))},saveCurrentSettings:()=>{const a={defaultVolume:n.value,defaultOrder:i.value,autoPlay:p.value,listFolded:l.value,isMinimized:o.value,customAudioList:e.value};try{replaceVariables(a,{type:'script',script_id:getScriptId()})}catch(e){console.warn('[APlayer] 保存设置失败:',e)}}}});var h,y;!function(e){e.AUDIO_LOAD_ERROR='audio_load_error',e.AUDIO_PLAY_ERROR='audio_play_error',e.NETWORK_ERROR='network_error',e.PERMISSION_ERROR='permission_error',e.UNKNOWN_ERROR='unknown_error'}(h||(h={})),function(e){e.IDLE='idle',e.LOADING='loading',e.SUCCESS='success',e.ERROR='error'}(y||(y={}));class g{maxRetries;retryDelay;constructor(e=3,a=1e3){this.maxRetries=e,this.retryDelay=a}async execute(e,a){let t;for(let n=1;n<=this.maxRetries;n++)try{return await e()}catch(e){t=e,n<this.maxRetries&&(a?.(n,e),await this.delay(this.retryDelay*Math.pow(2,n-1)))}throw t}delay(e){return new Promise(a=>setTimeout(a,e))}}const v={class:'aplayer-control'},f=['disabled'],x=['title'],b={class:'fas fa-play'},E={class:'fas fa-pause'},w=['disabled'],B=(0,A.defineComponent)({__name:'PlayerControls',props:{isPlaying:{type:Boolean},canSkipPrev:{type:Boolean},canSkipNext:{type:Boolean}},emits:['play','pause','prev','next','toggle-list'],setup:e=>(a,t)=>((0,A.openBlock)(),(0,A.createElementBlock)('div',v,[(0,A.createElementVNode)('button',{class:'aplayer-prev aplayer-control-btn',disabled:!e.canSkipPrev,title:'上一首',onClick:t[0]||(t[0]=e=>a.$emit('prev'))},[...t[4]||(t[4]=[(0,A.createElementVNode)('i',{class:'fas fa-step-backward'},null,-1)])],8,f),(0,A.createElementVNode)('button',{class:'aplayer-play-btn aplayer-control-btn',title:e.isPlaying?'暂停':'播放',onClick:t[1]||(t[1]=t=>e.isPlaying?a.$emit('pause'):a.$emit('play'))},[(0,A.withDirectives)((0,A.createElementVNode)('i',b,null,512),[[A.vShow,!e.isPlaying]]),(0,A.withDirectives)((0,A.createElementVNode)('i',E,null,512),[[A.vShow,e.isPlaying]])],8,x),(0,A.createElementVNode)('button',{class:'aplayer-next aplayer-control-btn',disabled:!e.canSkipNext,title:'下一首',onClick:t[2]||(t[2]=e=>a.$emit('next'))},[...t[5]||(t[5]=[(0,A.createElementVNode)('i',{class:'fas fa-step-forward'},null,-1)])],8,w),(0,A.createElementVNode)('button',{class:'aplayer-menu aplayer-control-btn',title:'菜单',onClick:t[3]||(t[3]=e=>a.$emit('toggle-list'))},[...t[6]||(t[6]=[(0,A.createElementVNode)('i',{class:'fas fa-bars'},null,-1)])])]))});i(944);var k=i(895);const N=(0,k.A)(B,[['__scopeId','data-v-625c8d59']]),S={class:'aplayer-list-ol'},P=['onClick'],R={class:'aplayer-list-index'},M={class:'aplayer-list-title'},O={class:'aplayer-list-author'},D=(0,A.defineComponent)({__name:'PlayList',props:{tracks:{},currentIndex:{},isVisible:{type:Boolean}},emits:['select-track'],setup:e=>(a,t)=>((0,A.openBlock)(),(0,A.createElementBlock)('div',{class:(0,A.normalizeClass)(['aplayer-list',{'aplayer-list-show':e.isVisible}])},[(0,A.createElementVNode)('ol',S,[((0,A.openBlock)(!0),(0,A.createElementBlock)(A.Fragment,null,(0,A.renderList)(e.tracks,(t,n)=>((0,A.openBlock)(),(0,A.createElementBlock)('li',{key:`track-${n}-${t.name}`,class:(0,A.normalizeClass)(['aplayer-list-light',{'aplayer-list-cur':n===e.currentIndex}]),onClick:e=>a.$emit('select-track',n)},[(0,A.createElementVNode)('span',R,(0,A.toDisplayString)(n+1),1),(0,A.createElementVNode)('span',M,(0,A.toDisplayString)(t.name),1),(0,A.createElementVNode)('span',O,(0,A.toDisplayString)(t.artist),1)],10,P))),128))])],2))});i(260);const I=(0,k.A)(D,[['__scopeId','data-v-a2dd2a0e']]),V=(0,A.defineComponent)({__name:'ProgressBar',props:{currentTime:{},duration:{},buffered:{}},emits:['seek'],setup(e,{emit:a}){const t=e,n=a,r=(0,A.ref)(),i=(0,A.computed)(()=>l(t.currentTime,t.duration)),o=(0,A.computed)(()=>l(t.buffered,t.duration)),s=e=>{if(!r.value||!t.duration)return;const a=r.value.getBoundingClientRect(),i=(e.clientX-a.left)/a.width*t.duration;n('seek',Math.max(0,Math.min(t.duration,i)))};return(e,a)=>((0,A.openBlock)(),(0,A.createElementBlock)('div',{class:'aplayer-bar-wrap',onClick:s},[(0,A.createElementVNode)('div',{class:'aplayer-bar',ref_key:'barRef',ref:r},[(0,A.createElementVNode)('div',{class:'aplayer-loaded',style:(0,A.normalizeStyle)({width:`${o.value}%`})},null,4),(0,A.createElementVNode)('div',{class:'aplayer-played',style:(0,A.normalizeStyle)({width:`${i.value}%`})},[...a[0]||(a[0]=[(0,A.createElementVNode)('span',{class:'aplayer-thumb'},null,-1)])],4)],512)]))}});i(142);const T=(0,k.A)(V,[['__scopeId','data-v-b5bb32c0']]),L={class:'aplayer-volume-wrap'},F={class:'aplayer-volume-bar-wrap'},U=(0,A.defineComponent)({__name:'VolumeControl',props:{volume:{},isMuted:{type:Boolean}},emits:['volume-change','toggle-mute'],setup(e,{emit:a}){const t=e,n=a,r=(0,A.ref)(),i=(0,A.ref)(!1),o=(0,A.computed)(()=>100*t.volume),l=(0,A.computed)(()=>t.isMuted||0===t.volume?'fas fa-volume-off':t.volume>.5?'fas fa-volume-up':'fas fa-volume-down'),s=e=>{if(!r.value)return;const a=r.value.getBoundingClientRect(),t=a.height-10,i=e.clientY-a.top-5;let A;A=i<=0?1:i>=t?0:1-i/t;const o=Math.max(0,Math.min(1,A));n('volume-change',o)},p=e=>{i.value||(e.stopPropagation(),s(e))},d=e=>{if(!r.value)return;e.preventDefault(),e.stopPropagation(),i.value=!0,s(e);$(document).on('mousemove.volumeControl',e=>{if(!i.value)return;const a=e.originalEvent;s(a)}),$(document).on('mouseup.volumeControl',()=>{i.value=!1,$(document).off('mousemove.volumeControl mouseup.volumeControl'),setTimeout(()=>{i.value=!1},10)})};return(e,a)=>((0,A.openBlock)(),(0,A.createElementBlock)('span',L,[(0,A.createElementVNode)('button',{class:'aplayer-volume-button',onClick:a[0]||(a[0]=a=>e.$emit('toggle-mute'))},[(0,A.createElementVNode)('i',{class:(0,A.normalizeClass)(l.value)},null,2)]),(0,A.createElementVNode)('div',F,[(0,A.createElementVNode)('div',{class:'aplayer-volume-bar',ref_key:'volumeBarRef',ref:r,onMousedown:d,onClick:p},[(0,A.createElementVNode)('div',{class:'aplayer-volume',style:(0,A.normalizeStyle)({height:`${o.value}%`})},null,4)],544)])]))}});i(177);const G=(0,k.A)(U,[['__scopeId','data-v-6d01fe2c']]),j={class:'aplayer-body'},W={class:'fas fa-play'},Y={class:'fas fa-pause'},K=['src','alt'],Q={class:'aplayer-info'},q={class:'aplayer-info-top'},H={class:'aplayer-music'},J={class:'aplayer-title'},X={class:'aplayer-author'},Z={class:'aplayer-controller'},ee={class:'aplayer-time'},ae={class:'aplayer-time-inner'},te={class:'aplayer-ptime'},ne={class:'aplayer-dtime'},re=['title'],ie=(0,A.defineComponent)({__name:'MusicPlayer',setup(e){const a=m(),{audioList:n,currentIndex:r,isPlaying:i,volume:l,order:s,isMinimized:d,listFolded:C,autoPlay:v,currentTime:f,duration:x,buffered:b,canSkipPrev:E,canSkipNext:w,isMuted:B}=t(a);let k,S;const P=(()=>{const e=(0,A.ref)([]),a=(0,A.ref)(null),t=(0,A.ref)(y.IDLE),n=_.throttle(t=>{const n={...t,timestamp:Date.now()};e.value.unshift(n),a.value=n,e.value.length>10&&(e.value=e.value.slice(0,10)),setTimeout(()=>{a.value===n&&(a.value=null)},5e3),console.error('[APlayer Error]',n)},1e3),r=e=>{t.value=e};return{errors:e,currentError:a,loadingState:t,addError:n,clearCurrentError:()=>{a.value=null},clearAllErrors:()=>{e.value=[],a.value=null},setLoadingState:r,handleAudioLoadError:(e,a,t)=>{let i='音频加载失败',A=h.AUDIO_LOAD_ERROR;t&&(t.message?.includes('network')?(A=h.NETWORK_ERROR,i='网络连接失败，无法加载音频'):t.message?.includes('permission')&&(A=h.PERMISSION_ERROR,i='没有权限播放该音频')),n({type:A,message:`${i}: ${e}`,trackName:e,trackUrl:a}),r(y.ERROR)},handleAudioPlayError:(e,a)=>{let t='音频播放失败';a&&('NotAllowedError'===a.name?t='播放被浏览器阻止，请手动点击播放按钮':'NotSupportedError'===a.name&&(t='该音频格式不受支持')),n({type:h.AUDIO_PLAY_ERROR,message:`${t}: ${e}`,trackName:e})},handleNetworkError:(e='网络连接失败')=>{n({type:h.NETWORK_ERROR,message:e})},handleUnknownError:(e,a='未知操作')=>{n({type:h.UNKNOWN_ERROR,message:`${a}时发生未知错误: ${e?.message||'未知错误'}`})}}})(),{handleAudioLoadError:R,handleAudioPlayError:M,setLoadingState:O}=P,D=(0,A.ref)(''),V=(0,A.ref)(!1),L=(0,A.computed)(()=>o(f.value).full),F=(0,A.computed)(()=>o(x.value).full),U=(0,A.computed)(()=>a.currentTrack),ie=(0,A.computed)(()=>{switch(s.value){case c.LIST:return'列表循环';case c.RANDOM:return'随机播放';case c.REPEAT_ONE:return'单曲循环';case c.NONE:return'播完停止';default:return'列表循环'}}),Ae=(0,A.computed)(()=>{switch(s.value){case c.RANDOM:return'fas fa-random';case c.REPEAT_ONE:return'fas fa-redo-alt';case c.NONE:return'fas fa-arrow-right';default:return'fas fa-retweet'}}),oe=async()=>{const e=a.currentTrack;if(e)try{D.value===e.url&&0!==k.duration||(console.log('[APlayer] 播放前检测到音频未加载，先加载音频'),await pe()),O(y.LOADING),await S.execute(()=>k.play(),(e,a)=>{console.warn(`播放重试 ${e}/3:`,a)}),a.setPlaying(!0),O(y.SUCCESS),console.log('[APlayer] 播放成功:',e.name)}catch(t){console.error('[APlayer] 播放失败:',t),M(e.name,t),a.setPlaying(!1),O(y.ERROR)}},le=()=>{k.pause(),a.setPlaying(!1),console.log('[APlayer] 已暂停播放')},se=()=>{i.value?le():oe()},pe=async()=>{const e=a.currentTrack;if(e&&!V.value)if(D.value!==e.url){V.value=!0,console.log('[APlayer] 开始加载音频:',e.name,e.url);try{O(y.LOADING),a.updateTime(0),a.updateDuration(0),a.updateBuffered(0),await S.execute(()=>k.loadTrack(e),(a,t)=>{console.warn(`音频加载重试 ${a}/3:`,e?.name,t)}),D.value=e.url,O(y.SUCCESS),console.log('[APlayer] 音频加载成功:',e.name)}catch(a){console.error('[APlayer] 加载音频失败:',a),R(e.name,e.url,a),O(y.ERROR),D.value='',setTimeout(()=>ue(),1500)}finally{V.value=!1}}else console.log('[APlayer] 音频已加载，跳过重复加载:',e.name)},de=async(e=!1)=>{const t=a.currentTrack;t&&(console.log('[APlayer] 开始切换歌曲到:',t.name),le(),D.value='',await pe(),e&&await oe())},ce=async()=>{const e=i.value;console.log('[APlayer] 点击上一首，当前播放状态:',e),a.skipToPrev(),await de(e)},ue=async()=>{const e=i.value;console.log('[APlayer] 点击下一首，当前播放状态:',e),a.skipToNext(),await de(e)},Ce=async e=>{const t=i.value;console.log('[APlayer] 选择歌曲索引:',e,'当前播放状态:',t),console.log('[APlayer] 选择的歌曲:',n.value[e]?.name),a.switchTo(e),await de(t)},me=e=>{k.duration>0?k.seek(e):console.warn('[APlayer] 无法快进，音频尚未加载完成')},he=e=>{a.setVolume(e),k.setVolume(e)},ye=()=>{a.toggleMute(),k.setVolume(l.value)},ge=()=>{const e=[c.LIST,c.RANDOM,c.REPEAT_ONE,c.NONE],t=e.indexOf(s.value),n=e[(t+1)%e.length];a.setOrder(n)},ve=()=>{a.toggleList()},fe=()=>{a.toggleMinimized()},xe=async()=>{switch(s.value){case c.REPEAT_ONE:k.seek(0),await oe();break;case c.NONE:le();break;case c.RANDOM:case c.LIST:default:a.skipToNext(),await de(!0)}};return(0,A.onMounted)(()=>{k=new p,S=new g(3,1e3),k.on(u.TIME_UPDATE,()=>{a.updateTime(k.currentTime)}),k.on(u.LOADED_METADATA,()=>{a.updateDuration(k.duration)}),k.on(u.PROGRESS,()=>{a.updateBuffered(k.buffered)}),k.on(u.ENDED,xe),k.on(u.ERROR,e=>{console.error('[APlayer] 音频播放错误:',e),U.value&&R(U.value.name,U.value.url,e),setTimeout(()=>ue(),1500)}),k.setVolume(l.value),U.value&&pe().then(()=>{v.value&&oe()})}),(0,A.onUnmounted)(()=>{k&&k.destroy()}),(0,A.watch)(r,async(e,a)=>{e!==a&&k&&(D.value='',await pe())},{immediate:!1}),(0,A.watch)(l,e=>{k&&k.setVolume(e)}),(e,a)=>((0,A.openBlock)(),(0,A.createElementBlock)('div',{class:(0,A.normalizeClass)(['aplayer',{'aplayer-narrow':(0,A.unref)(d)}])},[(0,A.createCommentVNode)(' 播放列表 '),(0,A.createVNode)(I,{tracks:(0,A.unref)(n),'current-index':(0,A.unref)(r),'is-visible':!(0,A.unref)(C),onSelectTrack:Ce},null,8,['tracks','current-index','is-visible']),(0,A.createElementVNode)('div',j,[(0,A.createCommentVNode)(' 封面和播放按钮 '),(0,A.createElementVNode)('div',{class:(0,A.normalizeClass)(['aplayer-pic',{'aplayer-pic-playing':(0,A.unref)(i)}]),onClick:se},[(0,A.createElementVNode)('div',{class:(0,A.normalizeClass)(['aplayer-button',{'aplayer-button-playing':(0,A.unref)(i)}])},[(0,A.withDirectives)((0,A.createElementVNode)('i',W,null,512),[[A.vShow,!(0,A.unref)(i)]]),(0,A.withDirectives)((0,A.createElementVNode)('i',Y,null,512),[[A.vShow,(0,A.unref)(i)]])],2),(0,A.createElementVNode)('img',{class:'aplayer-pic-img',src:U.value?.cover,alt:U.value?.name||'封面'},null,8,K)],2),(0,A.createCommentVNode)(' 播放信息和控制 '),(0,A.createElementVNode)('div',Q,[(0,A.createElementVNode)('div',q,[(0,A.createCommentVNode)(' 歌曲信息 '),(0,A.createElementVNode)('div',H,[(0,A.createElementVNode)('span',J,(0,A.toDisplayString)(U.value?.name||'未知歌曲'),1),(0,A.createElementVNode)('span',X,' - '+(0,A.toDisplayString)(U.value?.artist||'未知艺术家'),1)]),(0,A.createCommentVNode)(' 控制按钮 '),(0,A.createVNode)(N,{'is-playing':(0,A.unref)(i),'can-skip-prev':(0,A.unref)(E),'can-skip-next':(0,A.unref)(w),onPlay:oe,onPause:le,onPrev:ce,onNext:ue,onToggleList:ve},null,8,['is-playing','can-skip-prev','can-skip-next'])]),(0,A.createElementVNode)('div',Z,[(0,A.createCommentVNode)(' 进度条 '),(0,A.createVNode)(T,{'current-time':(0,A.unref)(f),duration:(0,A.unref)(x),buffered:(0,A.unref)(b),onSeek:me},null,8,['current-time','duration','buffered']),(0,A.createCommentVNode)(' 时间和音量 '),(0,A.createElementVNode)('div',ee,[(0,A.createElementVNode)('span',ae,[(0,A.createElementVNode)('span',te,(0,A.toDisplayString)(L.value),1),a[0]||(a[0]=(0,A.createTextVNode)(' / ',-1)),(0,A.createElementVNode)('span',ne,(0,A.toDisplayString)(F.value),1)]),(0,A.createVNode)(G,{volume:(0,A.unref)(l),'is-muted':(0,A.unref)(B),onVolumeChange:he,onToggleMute:ye},null,8,['volume','is-muted']),(0,A.createElementVNode)('button',{class:'aplayer-order',title:ie.value,onClick:ge},[(0,A.createElementVNode)('i',{class:(0,A.normalizeClass)(Ae.value)},null,2)],8,re)])])]),(0,A.createCommentVNode)(' 收缩/展开按钮 '),(0,A.createElementVNode)('div',{class:'aplayer-miniswitcher'},[(0,A.createElementVNode)('button',{class:'aplayer-icon',onClick:fe},[...a[1]||(a[1]=[(0,A.createElementVNode)('svg',{xmlns:'http://www.w3.org/2000/svg',version:'1.1',viewBox:'0 0 32 32'},[(0,A.createElementVNode)('path',{d:'M22 16l-10.105-10.6-1.895 1.987 8.211 8.613-8.211 8.612 1.895 1.988 8.211-8.613z'})],-1)])])])])],2))}});i(436);const Ae=(0,k.A)(ie,[['__scopeId','data-v-1409529e']]),oe=z,le=oe.z.object({defaultVolume:oe.z.number().min(0).max(1).default(.7),defaultOrder:oe.z.enum(c).default(c.LIST),autoPlay:oe.z.boolean().default(!1),listFolded:oe.z.boolean().default(!0),isMinimized:oe.z.boolean().default(!1),customAudioList:oe.z.array(oe.z.object({name:oe.z.string(),artist:oe.z.string(),url:oe.z.url(),cover:oe.z.url().optional()})).optional()});class se{static instance=null;playerApp=null;container=null;piniaInstance=null;constructor(){this.bindGlobalEvents()}static getInstance(){return this.instance??=new se,this.instance}createPlayer=_.once((e=d)=>{try{this.cleanup(),this.initializeContainer(),this.createVueApplication(),this.handleStyleInjection(),this.applyUserSettings(),console.log('[APlayer] 播放器创建成功')}catch(e){this.handleError('创建播放器',e)}});destroyPlayer(){this.cleanup(),this.resetInstance(),console.log('[APlayer] 播放器已销毁')}initializeContainer(){$('#aplayer-container').length?this.container=$('#aplayer-container'):(this.container=$('<div>').attr('id','aplayer-container'),$('body').append(this.container))}createVueApplication(){this.piniaInstance=e(),this.playerApp=(0,A.createApp)(Ae),this.playerApp.use(this.piniaInstance),this.playerApp.mount(this.container[0])}handleStyleInjection=_.debounce(()=>{this.teleportStyle()},150);teleportStyle(){$(`head > div[script_id="${getScriptId()}"]`,window.parent.document).length||($('<div>').attr('script_id',getScriptId()).append($('head > style',document).clone()).appendTo($('head',window.parent.document)),console.log('[APlayer] 样式已注入到酒馆页面 <head>'))}deteleportStyle(){$(`head > div[script_id="${getScriptId()}"]`,window.parent.document).remove()}applyUserSettings(){try{const e=getVariables({type:'script',script_id:getScriptId()}),a=pe.processSettings(e);this.applySettingsToStore(a),console.log('[APlayer] 已加载播放器设置:',a)}catch(e){console.warn('[APlayer] 加载播放器设置失败，使用默认设置:',e),this.useDefaultSettings()}}applySettingsToStore(e){if(!this.piniaInstance)return void this.handleError('应用设置','Pinia 实例未初始化');const a=m(this.piniaInstance);a?.initFromSettings?a.initFromSettings(e):this.handleError('应用设置','Store 或 initFromSettings 方法不存在')}useDefaultSettings(){const e=le.parse({});pe.saveSettings(e)}cleanup(){this.playerApp&&(this.playerApp.unmount(),this.playerApp=null),this.container&&(this.container.remove(),this.container=null),this.piniaInstance=null,this.deteleportStyle(),$(document).off('click.aplayerVue')}resetInstance(){se.instance=null}bindGlobalEvents(){$(document).on('click.aplayerVue',this.handleOutsideClick),$(window).on('pagehide',()=>this.destroyPlayer())}handleOutsideClick=e=>{$(e.target).closest('#aplayer-container .aplayer-menu, #aplayer-container .aplayer-list').length||this.closePlaylistIfOpen()};closePlaylistIfOpen(){if(this.playerApp?._instance&&this.piniaInstance)try{const e=this.piniaInstance._s,a=e?.get('player');if(a&&!a.listFolded)return void a.toggleList()}catch(e){console.warn('[APlayer] 通过 store 关闭播放列表失败，使用 DOM 操作:',e)}const e=$('#aplayer-container .aplayer-list');e.hasClass('aplayer-list-show')&&e.removeClass('aplayer-list-show')}handleError=_.throttle((e,a)=>{const t=`[APlayer ${e}]: ${a?.message||a}`;console.error(t)},2e3)}const pe={saveSettings:_.debounce(e=>{replaceVariables(e,{type:'script',script_id:getScriptId()})},500),processSettings:_.flow([e=>{return a=e,le.parse(a);var a},e=>(pe.saveSettings(e),e)]),logError:_.throttle((e,a)=>{console.error(`[APlayer] ${e}:`,a)},1e3)};let de;const ce=(e=d)=>{de=se.getInstance(),de.createPlayer(e)},ue=()=>{de&&de.destroyPlayer()},Ce=_.debounce(()=>{ce()},1e3,{leading:!1,trailing:!0,maxWait:2e3});$(()=>{eventOn(tavern_events.APP_READY,Ce)});export{ce as createMusicPlayer,ue as destroyMusicPlayer};
//# sourceMappingURL=index.js.map